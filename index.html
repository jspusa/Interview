<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>é¢è©¦è©•åˆ†è¡¨</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang TC",
        "Microsoft JhengHei", sans-serif;
    }

    body {
      margin: 0;
      padding: 28px;
      background: radial-gradient(circle at 20% 20%, #eef2ff 0, transparent 25%),
        radial-gradient(circle at 80% 0, #e0f2fe 0, transparent 25%),
        radial-gradient(circle at 10% 80%, #fdf2f8 0, transparent 22%),
        #f5f6fb;
      color: #0f172a;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      background: #ffffff;
      padding: 28px 28px 36px;
      border-radius: 18px;
      box-shadow: 0 20px 40px rgba(15, 23, 42, 0.16);
      border: 1px solid #e2e8f0;
    }

    h1 {
      text-align: center;
      margin-top: 0;
      margin-bottom: 4px;
      font-size: 26px;
      letter-spacing: 0.06em;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      color: #475569;
      margin-bottom: 26px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px 18px;
      margin-bottom: 20px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      font-size: 13px;
      font-weight: 700;
      color: #1f2937;
    }

    input[type="text"],
    input[type="date"],
    select,
    textarea {
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #d7dce3;
      font-size: 13px;
      transition: border-color 0.15s ease, box-shadow 0.15s ease,
        background-color 0.15s ease;
      background: #f8fafc;
      width: 100%;
    }

    input[type="text"]:focus,
    input[type="date"]:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(129, 140, 248, 0.18);
      background: #ffffff;
    }

    textarea {
      min-height: 120px;
      resize: vertical;
    }

    .section-card {
      border-radius: 16px;
      border: 1px solid #e2e8f0;
      padding: 18px 20px 20px;
      margin-bottom: 18px;
      background: linear-gradient(145deg, #ffffff 0%, #f9fafb 45%, #f8fafc 100%);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      border-bottom: 1px dashed #e5e7eb;
      padding-bottom: 6px;
      gap: 12px;
      flex-wrap: wrap;
    }

    .section-title {
      font-size: 15px;
      font-weight: 800;
    }

    .section-meta {
      font-size: 12px;
      color: #6b7280;
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }

    .weight-pill {
      background: #eef2ff;
      color: #4338ca;
      border-radius: 999px;
      padding: 2px 10px;
      font-size: 11px;
      font-weight: 600;
    }

    .score-standard-card {
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 16px;
      padding: 16px 18px 20px;
      margin-bottom: 20px;
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    .score-standard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px 16px;
      margin-bottom: 16px;
    }

    .score-standard-block {
      background: #ffffff;
      border-radius: 14px;
      border: 1px solid #e5e7eb;
      padding: 12px 14px;
    }

    .score-standard-title {
      font-weight: 700;
      font-size: 13px;
      margin-bottom: 6px;
      color: #1f2937;
    }

    .score-standard-list {
      margin: 0;
      padding-left: 16px;
      font-size: 12px;
      color: #475569;
      line-height: 1.6;
    }

    .weight-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 12px;
      margin-top: 8px;
    }

    .weight-table th,
    .weight-table td {
      border: 1px solid #e2e8f0;
      padding: 6px 8px;
      text-align: center;
    }

    .weight-table th {
      background: #f1f5f9;
      font-weight: 700;
    }

    .weight-note {
      font-size: 12px;
      color: #475569;
      margin-top: 8px;
      display: flex;
      gap: 6px;
      align-items: center;
    }

    .role-hint {
      color: #475569;
    }

    .item-row {
      display: grid;
      grid-template-columns: minmax(140px, 160px) 160px 1fr;
      gap: 10px;
      align-items: flex-start;
      padding: 8px 0;
      border-bottom: 1px dashed #f3f4f6;
    }

    .item-row:last-child {
      border-bottom: none;
    }

    .item-label {
      font-size: 13px;
      font-weight: 700;
      color: #374151;
      padding-top: 4px;
    }

    .score-wrapper {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .score-select-row {
      display: flex;
      gap: 6px;
      align-items: center;
      font-size: 12px;
      color: #6b7280;
      flex-wrap: wrap;
    }

    .score-select-row.star-target {
      flex-direction: column;
      align-items: flex-start;
      gap: 4px;
    }

    .star-row {
      display: flex;
      gap: 6px;
      align-items: center;
      flex-wrap: wrap;
    }

    .star {
      cursor: pointer;
      font-size: 18px;
      color: #cbd5e1;
      transition: color 0.12s ease, transform 0.12s ease;
      line-height: 1;
    }

    .star.active {
      color: #fbbf24;
    }

    .star:hover {
      transform: translateY(-1px);
      color: #f59e0b;
    }

    .star-labels {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      color: #475569;
      gap: 8px;
      margin-top: 2px;
    }

    .star-labels .mid {
      text-align: center;
      flex: 1;
      color: #334155;
      font-weight: 700;
    }

    .star-labels span:first-child,
    .star-labels span:last-child {
      flex: 1;
    }

    .star-labels span:last-child {
      text-align: right;
    }

    .field[data-disabled="true"] label,
    .field[data-disabled="true"] .helper {
      color: #94a3b8;
    }

    .comment-label {
      font-size: 12px;
      color: #6b7280;
    }

    .label-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .guideline-toggle {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #c7d2fe;
      background: #eef2ff;
      color: #4338ca;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
    }

    .guideline-section + .guideline-section {
      border-top: 1px dashed #e0e7ff;
      padding-top: 6px;
      margin-top: 6px;
    }

    .guideline-heading {
      font-weight: 700;
      color: #1d4ed8;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.35);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 1000;
    }

    .modal-dialog {
      background: #ffffff;
      border-radius: 18px;
      max-width: 520px;
      width: 100%;
      box-shadow: 0 25px 50px rgba(15, 23, 42, 0.25);
      border: 1px solid #e0e7ff;
      animation: fadeIn 0.2s ease;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 18px 20px 12px;
      border-bottom: 1px solid #f1f5f9;
      gap: 12px;
    }

    .modal-body {
      padding: 16px 20px 22px;
      max-height: 65vh;
      overflow-y: auto;
      font-size: 13px;
      color: #1f2937;
    }

    .modal-eyebrow {
      font-size: 11px;
      letter-spacing: 0.08em;
      color: #6366f1;
      text-transform: uppercase;
      margin-bottom: 2px;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 800;
      margin: 0;
    }

    .modal-close {
      border: none;
      background: #eef2ff;
      color: #4338ca;
      border-radius: 999px;
      width: 34px;
      height: 34px;
      font-size: 18px;
      cursor: pointer;
    }

    .modal-section ul {
      margin: 6px 0 8px 18px;
      padding: 0;
    }

    body.modal-open {
      overflow: hidden;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(12px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .total-row {
      margin-top: 16px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px 16px;
      align-items: center;
      padding: 12px 14px;
      border-radius: 14px;
      background: #f8fafc;
      border: 1px dashed #d7dce3;
    }

    .total-row label {
      margin-right: 4px;
    }

    .total-score {
      font-size: 20px;
      font-weight: 800;
      color: #0f172a;
      min-width: 60px;
      text-align: center;
    }

    .total-hint {
      font-size: 12px;
      color: #6b7280;
    }

    .actions {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: flex-end;
    }

    button {
      border: none;
      cursor: pointer;
      border-radius: 999px;
      padding: 9px 16px;
      font-size: 13px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.08s ease, box-shadow 0.08s ease,
        background-color 0.15s ease;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: #ffffff;
      box-shadow: 0 8px 18px rgba(79, 70, 229, 0.35);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(79, 70, 229, 0.45);
      background: linear-gradient(135deg, #4338ca, #4f46e5);
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #374151;
    }

    .btn-secondary:hover {
      background: #d1d5db;
      transform: translateY(-1px);
    }

    .btn-ghost {
      background: transparent;
      color: #4338ca;
      border: 1px solid #e0e7ff;
      padding: 8px 14px;
      border-radius: 12px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      padding: 6px 12px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      font-size: 12px;
      gap: 6px;
    }

    .muted {
      color: #6b7280;
      font-size: 12px;
    }

    .ai-tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 8px 10px;
      margin-top: 8px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 12px;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      font-size: 12px;
      color: #1f2937;
    }

    .hidden {
      display: none;
    }

    .disc-box {
      margin-top: 8px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      background: #f8fafc;
      color: #1f2937;
      line-height: 1.5;
    }

    .disc-title {
      font-weight: 700;
      margin-bottom: 4px;
      color: #111827;
    }

    .disc-tag {
      display: inline-block;
      margin-bottom: 6px;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      font-size: 12px;
      border: 1px solid #e0e7ff;
    }

    small.helper {
      display: block;
      font-size: 11px;
      color: #9ca3af;
      margin-top: 2px;
    }

    .collapse-toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 12px;
      background: #eef2ff;
      color: #4338ca;
      border: 1px solid #e0e7ff;
      font-weight: 700;
    }

    .accordion {
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 12px 14px;
      background: #fbfcff;
      margin-top: 12px;
    }

    .accordion details {
      border-bottom: 1px dashed #e5e7eb;
      padding: 8px 0;
    }

    .accordion details:last-child {
      border-bottom: none;
    }

    .accordion summary {
      cursor: pointer;
      font-weight: 700;
      color: #1f2937;
      outline: none;
    }

    .accordion ul {
      margin: 8px 0 0 18px;
      color: #374151;
      line-height: 1.5;
      font-size: 13px;
    }

    .sub-note {
      color: #6b7280;
      font-size: 12px;
      margin: 8px 0 0 18px;
    }

    .pet-options,
    .radio-row,
    .inline-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .tag-pill {
      padding: 6px 10px;
      border-radius: 10px;
      border: 1px solid #e2e8f0;
      background: #f8fafc;
      font-size: 12px;
      color: #1f2937;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .notes-list {
      display: grid;
      gap: 12px;
    }

    .note-card {
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      padding: 12px;
      background: #f9fafb;
    }

    .note-card textarea {
      min-height: 100px;
    }

    .note-toolbar {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 8px;
    }

    .btn-remove-note {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #fecdd3;
      background: #fff1f2;
      color: #be123c;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
    }

    .erp-details {
      margin-top: 8px;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 10px 12px;
      background: #f8fafc;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .erp-other-input {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #d7dce3;
      font-size: 13px;
      background: #ffffff;
    }

    @media (max-width: 960px) {
      .item-row {
        grid-template-columns: 1fr;
      }

      .item-label {
        padding-top: 0;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>é¢è©¦è©•åˆ†è¡¨</h1>
    <div class="subtitle">è«‹ä¾å¯¦éš›é¢è©¦æƒ…æ³è©•åˆ†èˆ‡å¡«å¯«è©•èªï¼Œå®Œæˆå¾Œå¯åŒ¯å‡ºç‚º Word æª”ã€‚</div>
    <div class="section-meta" style="justify-content:flex-end; display:flex; gap:10px; align-items:center; margin-bottom:6px;">
      <span class="helper">é»æ“Šå³å¯æŸ¥çœ‹è©•åˆ†é¡åˆ¥èˆ‡æ¬Šé‡åƒè€ƒ</span>
      <button type="button" class="btn-ghost" id="openScoreStandard">æŸ¥çœ‹è©•åˆ†é¡åˆ¥è¡¨</button>
    </div>

    <!-- åŸºæœ¬è³‡æ–™ -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">åŸºæœ¬è³‡æ–™</div>
        <div class="section-meta">è«‹å…ˆç¢ºèªé¢è©¦å°è±¡èˆ‡é¢è©¦å®˜è³‡è¨Š</div>
      </div>
      <div class="grid">
        <div class="field" id="roleTypeField">
          <label for="roleType">æ‡‰å¾µè·å‹™é¡å‹</label>
          <select id="roleType">
            <option value="">â€” è«‹å…ˆé¸æ“‡è·å‹™é¡å‹ â€”</option>
            <option value="general">ä¸€èˆ¬è·å‹™ï¼ˆé€šæ‰ã€æ–‡æ›¸ã€åŠ©ç†ç­‰ï¼‰</option>
            <option value="professional">å°ˆæ¥­è·å‹™ï¼ˆå°ˆæ¥­ç§‘ç³»ã€æœƒè¨ˆã€å“ç®¡ç­‰ï¼‰</option>
            <option value="manager">ä¸»ç®¡è·ï¼ˆéœ€å¸¶é ˜åœ˜éšŠä¹‹è·å‹™ï¼‰</option>
          </select>
          <small class="helper role-hint">è«‹å…ˆç¢ºèªæ‡‰å¾µé¡å‹ï¼Œå¾ŒçºŒæ¬„ä½æœƒä¾æ­¤é–‹å•Ÿä¸¦èª¿æ•´é¡Œçµ„ã€‚</small>
        </div>
        <div class="field">
          <label for="candidateName">æ‡‰è˜è€…å§“å</label>
          <input type="text" id="candidateName" data-requires-role />
        </div>
        <div class="field">
          <label for="position">é¢è©¦è·ä½</label>
          <input type="text" id="position" data-requires-role />
        </div>
        <div class="field">
          <label for="interviewDate">é¢è©¦æ—¥æœŸ</label>
          <input type="date" id="interviewDate" data-requires-role />
        </div>
        <div class="field">
          <label for="interviewer">é¢è©¦å®˜å§“å</label>
          <input type="text" id="interviewer" data-requires-role />
        </div>
        <div class="field" style="grid-column: 1 / -1;">
          <label for="interviewParticipants">é¢è©¦åƒèˆ‡è€…</label>
          <textarea
            id="interviewParticipants"
            data-requires-role
            placeholder="ä¾‹ï¼šäººè³‡ Johnã€éƒ¨é–€ä¸»ç®¡ Maxã€ç®¡ç†å¤¥ä¼´ Chrissy"
          ></textarea>
        </div>
      </div>
    </div>

    <!-- ä¸€ã€åŸºæœ¬ä¿¡æ¯ -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">ä¸€ã€åŸºæœ¬ä¿¡æ¯</div>
        <div class="section-meta">
          <span class="weight-pill" data-weight-label="basic">æ¬Šé‡ï¼š15%</span>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>å±¥æ­·å®Œæ•´åº¦</span>
            <button type="button" class="guideline-toggle" data-guideline="basic_resume" data-guideline-title="å±¥æ­·å®Œæ•´åº¦">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="basic_resume_score"></div>
          <input type="hidden" id="basic_resume_score" class="score-input" data-field />
          <small class="helper">å±¥æ­·æ˜¯å¦æ¸…æ¥šã€å®Œæ•´å‘ˆç¾èˆ‡è·ä½ç›¸é—œè³‡è¨Š</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="basic_resume_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>æ•™è‚²èƒŒæ™¯</span>
            <button type="button" class="guideline-toggle" data-guideline="basic_edu" data-guideline-title="æ•™è‚²èƒŒæ™¯">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="basic_edu_score"></div>
          <input type="hidden" id="basic_edu_score" class="score-input" data-field />
          <small class="helper">å­¸æ­·æ˜¯å¦ç¬¦åˆè·ä½éœ€æ±‚ï¼Œå°ˆæ¥­ç›¸é—œæ€§</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="basic_edu_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>å·¥ä½œç¶“æ­·</span>
            <button type="button" class="guideline-toggle" data-guideline="basic_exp" data-guideline-title="å·¥ä½œç¶“æ­·">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="basic_exp_score"></div>
          <input type="hidden" id="basic_exp_score" class="score-input" data-field />
          <small class="helper">éå¾€ç¶“æ­·èˆ‡è·å‹™å…§å®¹ä¹‹åŒ¹é…ç¨‹åº¦</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="basic_exp_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>å·¥ä½œç©©å®šæ€§ï¼ˆå«é›¢è·åŸå› ï¼‰</span>
            <button type="button" class="guideline-toggle" data-guideline="basic_stability" data-guideline-title="å·¥ä½œç©©å®šæ€§">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="basic_stability_score"></div>
          <input type="hidden" id="basic_stability_score" class="score-input" data-field />
          <small class="helper">0 åˆ†ï¼šé›¢è·é »ç¹ã€ç†ç”±ä¸æ¸…æ™°ï¼›5 åˆ†ï¼šç†ç”±åˆç†ä½†è½‰è·åå¤šï¼›10 åˆ†ï¼šè½‰è·å°‘ã€ç†ç”±æ¸…æ¥šä¸”è·æ¶¯æ–¹å‘ä¸€è‡´</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="basic_stability_comment"></textarea>
        </div>
      </div>
    </div>

    <!-- äºŒã€å°ˆæ¥­èƒ½åŠ› -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">äºŒã€å°ˆæ¥­èƒ½åŠ›</div>
        <div class="section-meta">
          <span class="weight-pill" data-weight-label="professional">æ¬Šé‡ï¼š35%</span>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>æŠ€è¡“æŠ€èƒ½</span>
            <button type="button" class="guideline-toggle" data-guideline="pro_tech" data-guideline-title="æŠ€è¡“æŠ€èƒ½">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="pro_tech_score"></div>
          <input type="hidden" id="pro_tech_score" class="score-input" data-field />
          <small class="helper">å°ˆæ¥­æŠ€èƒ½ç†Ÿç·´åº¦ã€å·¥å…·èˆ‡ç³»çµ±ä½¿ç”¨èƒ½åŠ›</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="pro_tech_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>å•é¡Œè§£æ±ºèƒ½åŠ›</span>
            <button type="button" class="guideline-toggle" data-guideline="pro_problem" data-guideline-title="å•é¡Œè§£æ±ºèƒ½åŠ›">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="pro_problem_score"></div>
          <input type="hidden" id="pro_problem_score" class="score-input" data-field />
          <small class="helper">åˆ†æèˆ‡è§£æ±ºå•é¡Œã€è½å¯¦æ–¹æ¡ˆèˆ‡é©—è­‰æ•ˆæœ</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="pro_problem_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>å­¸ç¿’èƒ½åŠ›</span>
            <button type="button" class="guideline-toggle" data-guideline="pro_learning" data-guideline-title="å­¸ç¿’èƒ½åŠ›">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="pro_learning_score"></div>
          <input type="hidden" id="pro_learning_score" class="score-input" data-field />
          <small class="helper">å­¸ç¿’æ–°çŸ¥èˆ‡è‡ªæˆ‘ç²¾é€²çš„æ„é¡˜èˆ‡æ–¹æ³•</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="pro_learning_comment"></textarea>
        </div>
      </div>
    </div>

    <!-- ä¸»ç®¡è·å°ˆç”¨ï¼šç®¡ç†èƒ½åŠ› -->
    <div class="section-card hidden" id="managementSection">
      <div class="section-header">
        <div class="section-title">ä¸»ç®¡è·å°ˆç”¨ â€” ç®¡ç†èƒ½åŠ›</div>
        <div class="section-meta">
          <span>3 é¡Œå…± 20% æ¬Šé‡</span>
          <span class="weight-pill" data-weight-label="management">æœªç´å…¥æ¬Šé‡</span>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>åœ˜éšŠç®¡ç†èˆ‡æˆæ¬Šèƒ½åŠ›</span>
            <button type="button" class="guideline-toggle" data-guideline="mgmt_team" data-guideline-title="åœ˜éšŠç®¡ç†èˆ‡æˆæ¬Šèƒ½åŠ›">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="mgmt_team_score"></div>
          <input type="hidden" id="mgmt_team_score" class="score-input" data-field disabled />
          <small class="helper">åˆ†å·¥ã€ç›®æ¨™è¨­å®šã€æˆæ¬Šèˆ‡è¿½è¹¤ã€é¢å°åœ˜éšŠå•é¡Œæ˜¯å¦é¡˜æ„æ‰¿æ“”èª¿æ•´</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="mgmt_team_comment" disabled></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>åˆ¶åº¦èˆ‡æµç¨‹å»ºç«‹èƒ½åŠ›</span>
            <button type="button" class="guideline-toggle" data-guideline="mgmt_process" data-guideline-title="åˆ¶åº¦èˆ‡æµç¨‹å»ºç«‹èƒ½åŠ›">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="mgmt_process_score"></div>
          <input type="hidden" id="mgmt_process_score" class="score-input" data-field disabled />
          <small class="helper">æ˜¯å¦èƒ½å°‡å·¥ä½œæµç¨‹åŒ–ã€ä¸»å‹•å„ªåŒ–åˆ¶åº¦ä¸¦æ¨å‹•è½åœ°</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="mgmt_process_comment" disabled></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>äººæ‰åŸ¹è‚²èˆ‡è·¨éƒ¨é–€å”èª¿</span>
            <button type="button" class="guideline-toggle" data-guideline="mgmt_talent" data-guideline-title="äººæ‰åŸ¹è‚²èˆ‡è·¨éƒ¨é–€å”èª¿">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="mgmt_talent_score"></div>
          <input type="hidden" id="mgmt_talent_score" class="score-input" data-field disabled />
          <small class="helper">åŸ¹è‚²äººæ‰çš„è¨ˆç•«èˆ‡æˆæ•ˆï¼Œä»¥åŠè·¨éƒ¨é–€å”èª¿èˆ‡è³‡æºæ•´åˆèƒ½åŠ›</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="mgmt_talent_comment" disabled></textarea>
        </div>
      </div>
    </div>

    <!-- ä¸‰ã€è»ŸæŠ€èƒ½ -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">ä¸‰ã€è»ŸæŠ€èƒ½</div>
        <div class="section-meta">
          <span>æ¯é …æ»¿åˆ† 10 åˆ†</span>
          <span class="weight-pill" data-weight-label="soft">æ¬Šé‡ï¼š35%</span>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>æºé€šèƒ½åŠ›</span>
            <button type="button" class="guideline-toggle" data-guideline="soft_comm" data-guideline-title="æºé€šèƒ½åŠ›">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="soft_comm_score"></div>
          <input type="hidden" id="soft_comm_score" class="score-input" data-field />
          <small class="helper">è³‡è¨Šè¡¨é”ã€å‚¾è½èˆ‡å‘ä¸Šæºé€šçš„æ•ˆç‡</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="soft_comm_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>åœ˜éšŠåˆä½œ</span>
            <button type="button" class="guideline-toggle" data-guideline="soft_team" data-guideline-title="åœ˜éšŠåˆä½œ">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="soft_team_score"></div>
          <input type="hidden" id="soft_team_score" class="score-input" data-field />
          <small class="helper">åœ˜éšŠåˆ†å·¥å”ä½œã€æ”¯æ´åŒä»èˆ‡å”èª¿èƒ½åŠ›</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="soft_team_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>æ™‚é–“ç®¡ç†</span>
            <button type="button" class="guideline-toggle" data-guideline="soft_time" data-guideline-title="æ™‚é–“ç®¡ç†">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="soft_time_score"></div>
          <input type="hidden" id="soft_time_score" class="score-input" data-field />
          <small class="helper">æ’ç¨‹èƒ½åŠ›ã€å„ªå…ˆé †åºåˆ¤æ–·èˆ‡äº¤ä»˜æº–æ™‚åº¦</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="soft_time_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>æŠ—å£“èƒ½åŠ›</span>
            <button type="button" class="guideline-toggle" data-guideline="soft_stress" data-guideline-title="æŠ—å£“èƒ½åŠ›">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="soft_stress_score"></div>
          <input type="hidden" id="soft_stress_score" class="score-input" data-field />
          <small class="helper">é¢å°å£“åŠ›æ™‚çš„ç©©å®šåº¦èˆ‡èª¿é©æ–¹æ³•</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="soft_stress_comment"></textarea>
        </div>
      </div>
    </div>

    <!-- å››ã€é¢è©¦è¡¨ç¾ -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">å››ã€é¢è©¦è¡¨ç¾</div>
        <div class="section-meta">
          <span class="weight-pill" data-weight-label="performance">æ¬Šé‡ï¼š15%</span>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>æ‡‰å°èƒ½åŠ›</span>
            <button type="button" class="guideline-toggle" data-guideline="perf_response" data-guideline-title="æ‡‰å°èƒ½åŠ›">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="perf_response_score"></div>
          <input type="hidden" id="perf_response_score" class="score-input" data-field />
          <small class="helper">è‡¨å ´åæ‡‰ã€èšç„¦é‡é»çš„èƒ½åŠ›</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="perf_response_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>è·æ¥­æ…‹åº¦</span>
            <button type="button" class="guideline-toggle" data-guideline="perf_attitude" data-guideline-title="è·æ¥­æ…‹åº¦">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="perf_attitude_score"></div>
          <input type="hidden" id="perf_attitude_score" class="score-input" data-field />
          <small class="helper">è²¬ä»»æ„Ÿã€ç©©å®šåº¦èˆ‡å°å·¥ä½œçš„èªçœŸç¨‹åº¦</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="perf_attitude_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>å„€è¡¨å„€æ…‹</span>
            <button type="button" class="guideline-toggle" data-guideline="perf_manner" data-guideline-title="å„€è¡¨å„€æ…‹">å±•é–‹æå•</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row star-target" data-star-for="perf_manner_score"></div>
          <input type="hidden" id="perf_manner_score" class="score-input" data-field />
          <small class="helper">ç©¿è‘—ã€ç¦®è²Œèˆ‡å°ˆæ¥­å½¢è±¡</small>
        </div>
        <div>
          <div class="comment-label">è©•èª</div>
          <textarea id="perf_manner_comment"></textarea>
        </div>
      </div>
    </div>

    <!-- ç¸½è©• -->
    <div class="section-card">
      <div class="total-row">
        <div style="display:flex;align-items:center;gap:6px;">
          <label>ç¸½åˆ†(æ»¿åˆ† 100 åˆ†)ï¼š</label>
          <div class="total-score" id="totalScore">â€”</div>
        </div>
        <div class="total-hint">
          ç³»çµ±æœƒä¾é¸æ“‡çš„è·å‹™é¡å‹è‡ªå‹•å¥—ç”¨æ¬Šé‡å¾Œæ›ç®—ç‚ºæ»¿åˆ† 100 åˆ†ã€‚è‹¥æœ‰æœªå¡«å¯«çš„é …ç›®ï¼Œç¸½åˆ†æœƒé™ä½ã€‚
        </div>
      </div>

      <div style="margin-top:12px;">
        <div class="field">
          <label for="overall_comment">ç¸½è©• â€” ç¶œåˆè©•åƒ¹åŠå»ºè­°</label>
          <textarea id="overall_comment" placeholder="ä¾‹å¦‚ï¼šæ•´é«”å°ˆæ¥­èƒ½åŠ›ä½³ï¼Œå»ºè­°éŒ„ç”¨ï¼å¯åˆ—å…¥å‚™é¸åå–®ï¼æš«ä¸é©åˆè©²è·ä½ç­‰ã€‚"></textarea>
        </div>
      </div>

      <div style="margin-top:12px;" class="grid">
        <div class="field">
          <label for="signature">é¢è©¦å®˜ç°½åï¼ˆå¯è¼¸å…¥å§“åï¼ŒWord ä¸­å¯å†æ‰‹ç°½ï¼‰ï¼š</label>
          <input type="text" id="signature" />
        </div>
      </div>
    </div>

    <!-- è£œå……è³‡è¨Šèˆ‡æå• -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">å€™é¸äººè‡ªè¿°èˆ‡è£œå……è³‡è¨Š</div>
        <div class="section-meta">æ”¾åœ¨æœ€å¾Œï¼Œæ–¹ä¾¿æ•´ç†é¢è«‡å¾Œçš„è£œå……ç´€éŒ„</div>
      </div>

      <div class="field">
        <label for="company_motivation">ç‚ºä»€éº¼é¸æ“‡æŠ•éæˆ‘å€‘å…¬å¸ï¼Ÿå°æˆ‘å€‘å…¬å¸èˆ‡å“ç‰Œæœ‰ä»€éº¼ç­è§£å—ï¼Ÿ</label>
        <small class="helper">å¯ç´€éŒ„å€™é¸äººçš„ç ”ç©¶ç¨‹åº¦ã€åƒ¹å€¼è§€å¥‘åˆåº¦èˆ‡è³‡è¨Šä¾†æºã€‚</small>
        <textarea
          id="company_motivation"
          placeholder="ä¾‹ï¼šè¢«ç”¢å“ç†å¿µæˆ–å“ç‰Œæ–‡åŒ–å¸å¼•ã€äº†è§£çš„æ¸ é“èˆ‡æ·±åº¦ç­‰"
        ></textarea>
      </div>

      <div class="field">
        <label for="achievement_note">å·¥ä½œä¸Šæœ€æœ‰æˆå°±æ„Ÿçš„äº‹æƒ…èˆ‡ç¶“é©—</label>
        <textarea
          id="achievement_note"
          placeholder="è«‹è¨˜éŒ„å…·é«”æ¡ˆä¾‹ã€é¢è©¦å®˜è§€å¯Ÿèˆ‡å¾ŒçºŒå¯è¿½å•çš„é‡é»"
        ></textarea>
      </div>
      <div class="field">
        <label for="challenge_note">å·¥ä½œä¸Šé‡åˆ°æœ€å¤§çš„æŒ«æŠ˜åŠè§£æ±ºæ–¹æ³•</label>
        <textarea
          id="challenge_note"
          placeholder="è«‹ç´€éŒ„æƒ…å¢ƒã€å€™é¸äººæ‡‰å°æ–¹å¼ä»¥åŠå­¸åˆ°çš„ç¶“é©—"
        ></textarea>
      </div>

      <div class="grid">
        <div class="field">
          <label for="strength_primary">å€™é¸äººè‡ªè¿°çš„å„ªé» #1</label>
          <small class="helper">ç¬¬ä¸€å€‹é€šå¸¸æ˜¯é¢è©¦è€…æº–å‚™å¥½çš„æ¨™æº–ç­”æ¡ˆï¼Œå¯ç´€éŒ„é¢è©¦å®˜è§€å¯Ÿèˆ‡æé†’ã€‚</small>
          <textarea id="strength_primary" placeholder="ä¾‹ï¼šæ“…é•·è·¨éƒ¨é–€æºé€šï¼éå¸¸ç†Ÿæ‚‰æµç¨‹ç­‰"></textarea>
        </div>
        <div class="field">
          <label for="strength_secondary">å€™é¸äººè‡ªè¿°çš„å„ªé» #2</label>
          <small class="helper">ç¬¬äºŒå€‹å¤šåŠè¼ƒè²¼è¿‘çœŸå¯¦æƒ³æ³•ï¼Œå¯è£œå……å…¶å¯¦éš›ä¾‹å­æˆ–å¯ä¿¡åº¦ã€‚</small>
          <textarea id="strength_secondary" placeholder="ä¾‹ï¼šæœ‰è€å¿ƒè™•ç†å®¢æˆ¶ã€å–œæ­¡è‡ªä¸»å­¸ç¿’ç­‰"></textarea>
        </div>
      </div>

      <div class="grid">
        <div class="field">
          <label for="weakness_primary">å€™é¸äººè‡ªè¿°çš„ç¼ºé» #1</label>
          <small class="helper">ç¬¬ä¸€å€‹å¸¸è¦‹æ–¼ç¶²è·¯æ•´ç†çš„ã€Œæ¨¡ç¯„ç­”æ¡ˆã€ï¼Œå¯è¨»è¨˜å…¶çœŸå¯¦æ€§ã€‚</small>
          <textarea id="weakness_primary" placeholder="ä¾‹ï¼šéœ€è¦åŠ å¼·ç°¡å ±èƒ½åŠ›ã€å¸Œæœ›æå‡æ•¸æ“šåŠ›ç­‰"></textarea>
        </div>
        <div class="field">
          <label for="weakness_secondary">å€™é¸äººè‡ªè¿°çš„ç¼ºé» #2</label>
          <small class="helper">é€šå¸¸è¼ƒè²¼è¿‘çœŸå¯¦ç‹€æ…‹ï¼Œå¯è¨˜éŒ„éœ€è¿½è¹¤æˆ–åŸ¹è¨“çš„æ–¹å‘ã€‚</small>
          <textarea id="weakness_secondary" placeholder="ä¾‹ï¼šå°é™Œç”Ÿé ˜åŸŸè¼ƒæ²’è‡ªä¿¡ã€éœ€è¦æé†’ç´°ç¯€ç­‰"></textarea>
        </div>
      </div>

      <div class="grid">
        <div class="field">
          <label>æ˜¯å¦æœ‰ä½¿ç”¨ AI è»Ÿé«”ï¼Ÿ</label>
          <div class="score-select-row" style="gap:10px;">
            <label class="chip"><input type="radio" name="ai_usage" value="yes" /> æœ‰</label>
            <label class="chip"><input type="radio" name="ai_usage" value="no" /> æ²’æœ‰</label>
            <span class="muted">è‹¥å‹¾é¸ã€Œæœ‰ã€ï¼Œå¯å‹¾é¸å¸¸ç”¨å·¥å…·</span>
          </div>
          <div id="aiToolsWrapper" class="ai-tools-grid hidden">
            <label class="chip"><input type="checkbox" class="ai-tool" value="ChatGPT" /> ChatGPT</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Adobe" /> Adobe</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Canva" /> Canva</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Gemini" /> Gemini</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Notion AI" /> Notion AI</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Microsoft Copilot" /> Microsoft Copilot</label>
            <div class="field" style="grid-column: 1 / -1; margin-top:4px;">
              <label for="ai_other" class="muted">å…¶ä»–å¸¸ç”¨ AIï¼ˆå¯è¼¸å…¥ï¼‰</label>
              <input type="text" id="ai_other" placeholder="è«‹å¡«å¯«å…¶ä»–å·¥å…·åç¨±æˆ–ä½¿ç”¨æƒ…å¢ƒ" />
            </div>
          </div>
        </div>

        <div class="field">
          <label>ERP ä½¿ç”¨ç¶“é©—ï¼Ÿ</label>
            <div class="muted">ä½¿ç”¨éçš„ ERP ç³»çµ±ï¼ˆå¯è¤‡é¸ï¼‰</div>
            <div class="inline-chips">
              <label class="chip"><input type="checkbox" class="erp-option" value="é¼æ–° ERP" /> é¼æ–° ERP</label>
              <label class="chip"><input type="checkbox" class="erp-option" value="ç„¡" /> ç„¡</label>
              <label class="chip"><input type="checkbox" id="erp_other_checkbox" class="erp-option" value="å…¶ä»–" data-other="true" /> å…¶ä»–ï¼Œè«‹å¡«å¯«</label>
            </div>
            <input type="text" id="erp_other" class="hidden erp-other-input" placeholder="ä¾‹å¦‚ï¼šSAPã€Oracleã€NetSuite ç­‰" />
          </div>
        </div>

        <div class="field">
          <label for="disc_type">DISC äººæ ¼æ¸¬é©—çµæœ</label>
          <select id="disc_type">
            <option value="">â€” è«‹é¸æ“‡ â€”</option>
            <option value="D">æ”¯é…å‹ï¼ˆDï¼‰- è€è™</option>
            <option value="I">å½±éŸ¿å‹ï¼ˆIï¼‰- å­”é›€</option>
            <option value="S">ç©©å¥å‹ï¼ˆSï¼‰- ç„¡å°¾ç†Š</option>
            <option value="C">è¬¹æ…å‹ï¼ˆCï¼‰- è²“é ­é·¹</option>
          </select>
          <div id="discResult" class="disc-box">
            <div class="disc-title">å°šæœªé¸æ“‡</div>
            <div class="muted">é¸æ“‡ DISC é¡å‹å¾Œï¼Œç³»çµ±æœƒè‡ªå‹•å¸¶å‡ºäººæ ¼ç‰¹è³ªèˆ‡é©åˆçš„è·å ´æƒ…å¢ƒï¼Œæ–¹ä¾¿è¨˜éŒ„åœ¨ Wordã€‚</div>
          </div>
        </div>
      </div>

      <div class="section-header" style="padding-top:8px;">
        <div class="section-title">è£œå……è³‡æ–™</div>
        <div class="section-meta">å¯µç‰©ç…§è­·èˆ‡å‚™è¨»</div>
      </div>
      <div class="grid">
        <div class="field">
          <label>æ˜¯å¦æœ‰é¤Šå¯µç‰©ï¼Ÿ</label>
          <div class="pet-options">
            <label class="tag-pill"><input type="radio" name="pet_status" value="yes" /> æœ‰</label>
            <label class="tag-pill"><input type="radio" name="pet_status" value="no" /> æ²’æœ‰</label>
            <label class="tag-pill"><input type="radio" name="pet_status" value="past" /> ä»¥å‰é¤Šé</label>
          </div>
          <small class="helper">é¸ã€Œæœ‰ã€æˆ–ã€Œä»¥å‰é¤Šéã€æ™‚ï¼Œè«‹å‹¾é¸é¡å‹ä¸¦å¡«å¯«ç…§è­·è³‡è¨Šã€‚</small>
        </div>
        <div class="field hidden" id="petTypesWrapper">
          <label>å¯µç‰©é¡å‹ï¼ˆå¯è¤‡é¸ï¼‰</label>
          <div class="inline-chips" id="petTypes">
            <label class="chip"><input type="checkbox" value="ç‹—" /> ç‹—</label>
            <label class="chip"><input type="checkbox" value="è²“" /> è²“</label>
            <label class="chip"><input type="checkbox" value="éçŠ¬è²“" /> éçŠ¬è²“</label>
          </div>
        </div>
      </div>
      <div class="field hidden" id="petFeederWrapper">
        <label>æ˜¯å¦ç‚ºé£¼æ–™æŒ‘é¸è€…ï¼Ÿ</label>
        <div class="radio-row">
          <label class="chip"><input type="radio" name="pet_feeder" value="yes" /> æ˜¯</label>
          <label class="chip"><input type="radio" name="pet_feeder" value="no" /> å¦</label>
        </div>
      </div>
      <div class="field">
        <label for="pet_note">å¯µç‰©ç›¸é—œå‚™è¨»</label>
        <textarea id="pet_note" placeholder="å¡«å¯«é£¼é¤Šç¶“é©—ã€ç…§è­·æ™‚é–“å®‰æ’ã€é£Ÿç‰©æŒ‘é¸è€ƒé‡ç­‰"></textarea>
      </div>

      <div class="section-header" style="padding-top:8px;">
        <div class="section-title">é¢è©¦è€…æå•</div>
        <div class="section-meta">å¯æŒçºŒæ–°å¢ï¼Œè®“é¢è©¦å®˜è¨˜éŒ„å›ç­”èˆ‡æƒ³æ³•</div>
        <button type="button" class="btn-ghost" id="addQuestion">ï¼‹ æ–°å¢æå•</button>
      </div>
      <div class="notes-list" id="questionList"></div>
    </div>

    <!-- æ“ä½œæŒ‰éˆ• -->
  <div class="actions">
    <button type="button" class="btn-secondary" onclick="resetForm()">
      é‡ç½®è¡¨å–®
    </button>
    <button type="button" class="btn-primary" onclick="exportToWord()">
      åŒ¯å‡ºç‚º Word
    </button>
  </div>
</div>

  <div id="scoreStandardModal" class="modal-backdrop hidden">
    <div class="modal-dialog">
      <div class="modal-header">
        <div>
          <div class="modal-eyebrow">è©•åˆ†é¡åˆ¥è¡¨</div>
          <div class="modal-title">è©•åˆ†æ¨™æº–èˆ‡æ¬Šé‡</div>
        </div>
        <button type="button" class="modal-close" data-close-modal>&times;</button>
      </div>
      <div class="modal-body">
        <div class="score-standard-grid">
          <div class="score-standard-block">
            <div class="score-standard-title">0â€“10 åˆ†æ¨™æº–ï¼ˆåŸºç¤ï¼é¢è©¦è¡¨ç¾ï¼‰</div>
            <ul class="score-standard-list">
              <li><strong>0â€“2ï¼š</strong>æ˜é¡¯ä¸è¶³ï¼Œéœ€å¤§é‡æŒ‡å°</li>
              <li><strong>3â€“4ï¼š</strong>å‹‰å¼·ç¬¦åˆï¼Œä»æœ‰ç¼ºå£</li>
              <li><strong>5â€“6ï¼š</strong>åŸºæœ¬åˆ°ä½ï¼Œå¯æ­£å¸¸åŸ·è¡Œ</li>
              <li><strong>7â€“8ï¼š</strong>ç©©å®šè¡¨ç¾ï¼Œé«˜æ–¼ä¸€èˆ¬</li>
              <li><strong>9â€“10ï¼š</strong>äº®çœ¼çªå‡ºï¼Œèƒ½å¸¶ä¾†åŠ å€¼</li>
            </ul>
          </div>
          <div class="score-standard-block">
            <div class="score-standard-title">0â€“10 åˆ†æ¨™æº–ï¼ˆå°ˆæ¥­ï¼ç®¡ç†ï¼‰</div>
            <ul class="score-standard-list">
              <li><strong>0â€“2ï¼š</strong>ç¼ºä¹ç¶“é©—æˆ–æ–¹æ³•è«–</li>
              <li><strong>3â€“4ï¼š</strong>å°šåœ¨å»ºç«‹åŸºç¤ï¼Œéœ€ç·Šå¯†å¸¶é ˜</li>
              <li><strong>5â€“6ï¼š</strong>èƒ½ç¨ç«‹å®Œæˆå¸¸è¦å·¥ä½œ</li>
              <li><strong>7â€“8ï¼š</strong>å¯å„ªåŒ–æµç¨‹ä¸¦å”ä½œ</li>
              <li><strong>9â€“10ï¼š</strong>ç­–ç•¥æ€§æ€è€ƒï¼Œèƒ½å¸¶äººæˆ–å‰µæ–°</li>
            </ul>
          </div>
        </div>
        <table class="weight-table">
          <thead>
            <tr>
              <th>è©•åˆ†é¡åˆ¥</th>
              <th>ä¸€èˆ¬è·å‹™</th>
              <th>å°ˆæ¥­è·å‹™</th>
              <th>ä¸»ç®¡è·å‹™</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>åŸºæœ¬è³‡è¨Š</td>
              <td>15%</td>
              <td>15%</td>
              <td>15%</td>
            </tr>
            <tr>
              <td>å°ˆæ¥­èƒ½åŠ›</td>
              <td>35%</td>
              <td>40%</td>
              <td>35%</td>
            </tr>
            <tr>
              <td>ç®¡ç†èƒ½åŠ›ï¼ˆä¸»ç®¡è·ï¼‰</td>
              <td>â€”</td>
              <td>â€”</td>
              <td>20%</td>
            </tr>
            <tr>
              <td>è»ŸæŠ€èƒ½</td>
              <td>35%</td>
              <td>30%</td>
              <td>20%</td>
            </tr>
            <tr>
              <td>é¢è©¦è¡¨ç¾</td>
              <td>15%</td>
              <td>15%</td>
              <td>10%</td>
            </tr>
          </tbody>
        </table>
        <div class="weight-note">ğŸ’¡ ä¸»ç®¡è·æœƒè‡ªå‹•å¢åŠ ã€Œç®¡ç†èƒ½åŠ› 20%ã€æ¬Šé‡ï¼Œå› æ­¤è»ŸæŠ€èƒ½èˆ‡é¢è©¦è¡¨ç¾æ¬Šé‡æœƒåŒæ­¥ä¸‹é™ã€‚</div>
      </div>
    </div>
  </div>

  <div id="guidelineModal" class="modal-backdrop hidden">
    <div class="modal-dialog">
      <div class="modal-header">
        <div>
          <div class="modal-eyebrow">æå•å°æŠ„</div>
          <div id="guidelineModalTitle" class="modal-title">é¢è©¦æå•å»ºè­°</div>
        </div>
        <button type="button" class="modal-close" data-close-modal>&times;</button>
      </div>
      <div class="modal-body">
        <div class="guideline-section">
          <div class="guideline-heading">å¯ä»¥å•ï¼š</div>
          <ul id="guidelineModalQuestions"></ul>
        </div>
        <div class="guideline-section">
          <div class="guideline-heading">é¢è©¦å®˜åƒè€ƒï¼š</div>
          <ul id="guidelineModalNotes"></ul>
        </div>
      </div>
    </div>
  </div>

  <script>
    // è‡ªå‹•è¨ˆç®—ç¸½åˆ†
    const scoreInputs = document.querySelectorAll(".score-input");
    const totalScoreEl = document.getElementById("totalScore");
    const roleTypeSelect = document.getElementById("roleType");
    const roleLockedFields = document.querySelectorAll("[data-requires-role]");
    const managementSection = document.getElementById("managementSection");
    const managementScoreInputs = managementSection
      ? managementSection.querySelectorAll(".score-input")
      : [];
    const managementCommentInputs = managementSection
      ? managementSection.querySelectorAll("textarea")
      : [];
    const weightLabels = document.querySelectorAll("[data-weight-label]");
    const aiUsageInputs = document.querySelectorAll("input[name='ai_usage']");
    const aiToolsWrapper = document.getElementById("aiToolsWrapper");
    const aiToolCheckboxes = document.querySelectorAll(".ai-tool");
    const aiOtherInput = document.getElementById("ai_other");
    const discSelect = document.getElementById("disc_type");
    const discResult = document.getElementById("discResult");
    const petStatusInputs = document.querySelectorAll("input[name='pet_status']");
    const petTypesWrapper = document.getElementById("petTypesWrapper");
    const petFeederWrapper = document.getElementById("petFeederWrapper");
    const questionList = document.getElementById("questionList");
    const addQuestionBtn = document.getElementById("addQuestion");
    const erpExperienceRadios = document.querySelectorAll("input[name='erp_experience']");
    const erpDetails = document.getElementById("erpDetails");
    const erpOtherCheckbox = document.getElementById("erp_other_checkbox");
    const erpOtherInput = document.getElementById("erp_other");
    const erpOptions = document.querySelectorAll(".erp-option");
    const guidelineToggles = document.querySelectorAll(".guideline-toggle");
    const guidelineModal = document.getElementById("guidelineModal");
    const guidelineModalTitle = document.getElementById("guidelineModalTitle");
    const guidelineModalQuestions = document.getElementById("guidelineModalQuestions");
    const guidelineModalNotes = document.getElementById("guidelineModalNotes");
    const scoreStandardModal = document.getElementById("scoreStandardModal");
    const openScoreStandardBtn = document.getElementById("openScoreStandard");
    const modalCloseButtons = document.querySelectorAll("[data-close-modal]");

    const guidelineData = {
      basic_resume: {
        questions: [
          "ã€Œä½ å¯ä¸å¯ä»¥ç”¨ 2ï½3 åˆ†é˜ç°¡å–®ä»‹ç´¹ä¸€ä¸‹ä½ çš„èƒŒæ™¯ï¼Ÿå¾æœ€è¿‘çš„ç¶“æ­·é–‹å§‹èªªå°±å¥½ã€‚ã€",
          "ã€Œä½ é€çµ¦æˆ‘å€‘çš„å±¥æ­·è£¡ï¼Œæœ‰å“ªå€‹éƒ¨åˆ†æ˜¯ä½ è¦ºå¾—æœ€èƒ½ä»£è¡¨ä½ è‡ªå·±ã€æœ€å¸Œæœ›æˆ‘å€‘çœ‹åˆ°çš„ï¼Ÿã€",
          "ã€Œæˆ‘çœ‹åˆ°ä½ åœ¨ XX å¹´åˆ° XX å¹´ä¹‹é–“æ²’æœ‰å·¥ä½œç´€éŒ„ï¼Œé‚£æ®µæ™‚é–“ä¸»è¦åœ¨åšäº›ä»€éº¼å‘¢ï¼Ÿã€"
        ],
        notes: [
          "ä»–èªªçš„å…§å®¹è·Ÿå±¥æ­·æ˜¯ä¸æ˜¯ä¸€è‡´ï¼Ÿï¼ˆä¸ä¸€è‡´è¦å°å¿ƒï¼‰",
          "æè¿°æ˜¯å¦æ¢ç†æ¸…æ¥šã€æœ‰é‚è¼¯ã€‚",
          "æ˜¯å¦æœ‰èª å¯¦é¢å°ç©ºç™½æœŸã€è½‰è·åŸå› ã€‚"
        ]
      },
      basic_edu: {
        questions: [
          "ã€Œç•¶åˆç‚ºä»€éº¼æœƒé¸æ“‡é€™å€‹ç§‘ç³»ï¼Ÿè·Ÿä½ ç¾åœ¨æ±‚è·çš„è·ä½ï¼Œä½ è¦ºå¾—æœ‰ä»€éº¼é€£çµï¼Ÿã€",
          "ã€Œåœ¨æ±‚å­¸æœŸé–“ï¼Œæœ‰æ²’æœ‰å“ªä¸€é–€èª²ç¨‹ã€å°ˆé¡Œæˆ–å ±å‘Šï¼Œè®“ä½ å°è±¡ç‰¹åˆ¥æ·±åˆ»ï¼Ÿä½ åœ¨è£¡é¢çš„è§’è‰²æ˜¯ä»€éº¼ï¼Ÿã€",
          "ã€Œå¦‚æœç”¨ä¸€å€‹ä¾‹å­èªªæ˜ï¼Œä½ è¦ºå¾—åœ¨å­¸æ ¡è£¡å­¸åˆ°ã€ç¾åœ¨å·¥ä½œä¹Ÿç”¨å¾—ä¸Šçš„æ±è¥¿æ˜¯ä»€éº¼ï¼Ÿã€"
        ],
        notes: [
          "å°ˆæ¥­æ˜¯å¦å’Œè·å‹™æœ‰é—œï¼ˆå°¤å…¶æ˜¯æœƒè¨ˆã€å“ä¿ã€ç ”ç™¼ç­‰æŠ€è¡“æ€§è·ä½ï¼‰ã€‚",
          "æ˜¯å¦èƒ½å¾å­¸æ ¡ç¶“é©—ä¸­æ•´ç†å‡ºå¯è½‰æ›åˆ°è·å ´çš„èƒ½åŠ›ã€‚",
          "æè¿°æ˜¯å¦å…·é«”ã€æœ‰ä¾‹å­ï¼Œè€Œä¸æ˜¯è¬›ä¸€å †ç©ºè©±ã€‚"
        ]
      },
      basic_exp: {
        questions: [
          "ã€Œåœ¨ä¸Šä¸€ä»½å·¥ä½œè£¡ï¼Œä½ è¦ºå¾—æœ€æœ‰æˆå°±æ„Ÿçš„ä¸€ä»¶äº‹æ˜¯ä»€éº¼ï¼Ÿä½ å…·é«”åšäº†å“ªäº›äº‹æƒ…ï¼Ÿã€",
          "ã€Œä½ é›¢é–‹ä¸Šä¸€ä»½å·¥ä½œçš„ä¸»è¦åŸå› æ˜¯ä»€éº¼ï¼Ÿã€",
          "ã€Œå¦‚æœç”¨ä¸€å€‹ä¾‹å­åˆ†äº«ï¼Œä½ è¦ºå¾—ä¹‹å‰çš„å·¥ä½œç¶“é©—ï¼Œå°é€™ä»½è·ç¼ºæœ€æœ‰å¹«åŠ©çš„æ˜¯å“ªä¸€å¡Šï¼Ÿã€"
        ],
        notes: [
          "æ˜¯å¦çœŸçš„åšéå±¥æ­·ä¸Šå¯«çš„äº‹æƒ…ï¼ˆç´°ç¯€ä¸€å•å°±çŸ¥é“ï¼‰ã€‚",
          "æ˜¯å¦å¸¸æ›å·¥ä½œã€æ¯æ¬¡é›¢è·åŸå› æ˜¯ä¸æ˜¯åˆç†ã€‚",
          "ä»–çš„è§’è‰²æ˜¯ã€Œä¸»å°ã€é‚„æ˜¯åªæ˜¯ã€ŒåŸ·è¡Œåˆ¥äººäº¤ä»£ã€ã€‚"
        ]
      },
      basic_stability: {
        questions: [
          "ã€Œä½ éå»å¹¾æ¬¡è½‰è·çš„è€ƒé‡æ˜¯ä»€éº¼ï¼Ÿé€šå¸¸æ˜¯å“ªäº›å› ç´ ä¿ƒä½¿ä½ åšæ±ºå®šï¼Ÿã€",
          "ã€Œä¸Šä¸€ä»½å·¥ä½œçš„é›¢è·åŸå› æ˜¯ä»€éº¼ï¼Ÿä½ ç•¶æ™‚æ€éº¼è©•ä¼°ï¼Ÿã€",
          "ã€Œæœªä¾† 2ï½3 å¹´çš„è·æ¶¯è¦ç•«æ˜¯ä»€éº¼ï¼Ÿé€™ä»½å·¥ä½œæ‰®æ¼”ä»€éº¼è§’è‰²ï¼Ÿã€"
        ],
        notes: [
          "é›¢è·åŸå› æ˜¯å¦å…·å‚™é‚è¼¯èˆ‡ä¸€è‡´æ€§ï¼Œé¿å…éåº¦è·³æ§½ã€‚",
          "è©•ä¼°æ˜¯å¦å®¹æ˜“è¢«æƒ…ç·’æˆ–äººéš›ç³¾ç´›å½±éŸ¿æ±ºå®šã€‚",
          "è§€å¯Ÿè·æ¶¯è¦ç•«æ˜¯å¦èˆ‡ç›®å‰è·ç¼ºæ–¹å‘ä¸€è‡´ã€‚"
        ]
      },
        pro_tech: {
        questions: [
          "ã€Œå¦‚æœä»¥ 1ï½10 åˆ†ä¾†çœ‹ï¼Œä½ æœƒçµ¦è‡ªå·±åœ¨ XX æŠ€èƒ½ï¼ˆä¾‹å¦‚ Excelã€å“è³ªæª¢é©—ã€æ©Ÿå°æ“ä½œï¼‰å¹¾åˆ†ï¼Ÿç‚ºä»€éº¼ï¼Ÿã€",
          "ã€Œä½ æœ€è¿‘ä¸€æ¬¡ç”¨åˆ°é€™å€‹æŠ€èƒ½ï¼Œæ˜¯åœ¨åšä»€éº¼ä»»å‹™ï¼Ÿæ–¹ä¾¿èˆ‰ä¸€å€‹å…·é«”ä¾‹å­å—ï¼Ÿã€",
          "ã€Œå¯¦å‹™ä¸Šé‡åˆ°ä¸ç†Ÿæ‚‰çš„å·¥å…·æˆ–ç³»çµ±ï¼Œä½ é€šå¸¸æ€éº¼å¿«é€Ÿä¸Šæ‰‹ï¼Ÿã€"
        ],
        notes: [
          "ä»–çµ¦è‡ªå·±çš„åˆ†æ•¸æ˜¯å¦åˆç†ï¼ˆå¯ä»¥è¿½å•ï¼šé‚£ VLOOKUPï¼æ¨ç´åˆ†æä½ æœƒå—ï¼Ÿç­‰ï¼‰ã€‚",
          "æœ‰æ²’æœ‰å¯¦éš›æ¡ˆä¾‹ï¼Œè€Œä¸æ˜¯åªèªªã€Œæˆ‘å¾ˆç†Ÿã€ã€‚",
          "è‹¥æ˜¯æŠ€è¡“è·ï¼Œå¯ä»¥è€ƒæ…®æƒ…å¢ƒé¡Œæˆ–ç•¶å ´æ“ä½œï¼ç­†è©¦ã€‚"
        ]
      },
      pro_problem: {
        questions: [
          "ã€Œéå»å·¥ä½œè£¡ï¼Œæœ‰æ²’æœ‰é‡éä¸€å€‹æ¯”è¼ƒæ£˜æ‰‹çš„å•é¡Œï¼Ÿä½ ç•¶æ™‚æ€éº¼ç™¼ç¾ã€æ€éº¼è™•ç†ï¼Ÿçµæœå¦‚ä½•ï¼Ÿã€",
          "ã€Œæ›¾ç¶“æœ‰æ²’æœ‰çŠ¯ééŒ¯ï¼Ÿä½ æ€éº¼ç™¼ç¾å•é¡Œã€æ€éº¼è£œæ•‘ï¼Ÿå¾Œä¾†æœ‰æ²’æœ‰åšä»€éº¼é¿å…å†ç™¼ç”Ÿï¼Ÿã€",
          "ã€Œé‡åˆ°å®¢è¨´ï¼ç”Ÿç”¢ç•°å¸¸ï¼æ–‡ä»¶å‡ºéŒ¯ï¼ˆä¾è·å‹™æ›ä¾‹å­ï¼‰ï¼Œä½ è¦ºå¾—è™•ç†çš„å„ªå…ˆé †åºæœƒæ˜¯ä»€éº¼ï¼Ÿç‚ºä»€éº¼ï¼Ÿã€"
        ],
        notes: [
          "ä»–æ˜¯ä¸æ˜¯åªæ˜¯åœ¨æŠ±æ€¨åˆ¥äººï¼Œé‚„æ˜¯æœƒè‡ªæˆ‘åçœã€æ‰¾æ–¹æ³•ã€‚",
          "æè¿°çš„æ­¥é©Ÿæœ‰æ²’æœ‰é‚è¼¯ï¼ˆå…ˆç¢ºèªå•é¡Œ â†’ æ‰¾åŸå›  â†’ ææ–¹æ¡ˆ â†’ æª¢è¨ï¼‰ã€‚",
          "æœ‰æ²’æœ‰çœŸæ­£è½åˆ°è¡Œå‹•èˆ‡çµæœï¼Œè€Œä¸æ˜¯åªèªªã€Œæˆ‘æœƒè·ŸåŒäº‹è¨è«–ã€ã€‚"
        ]
      },
      pro_learning: {
        questions: [
          "ã€Œæœ€è¿‘ä¸€å¹´ï¼Œä½ ä¸»å‹•å­¸ç¿’æˆ–è‡ªæˆ‘é€²ä¿®çš„å…§å®¹æœ‰å“ªäº›ï¼Ÿå¯ä»¥èˆ‰ä¸€å€‹æœ€å…·é«”çš„ä¾‹å­ï¼Ÿã€",
          "ã€Œé‡åˆ°ä¸æœƒçš„å·¥ä½œå…§å®¹ï¼Œé€šå¸¸ä½ ç¬¬ä¸€æ­¥æœƒæ€éº¼åšï¼Ÿä¸Šç¶²æŸ¥ï¼Ÿå•åŒäº‹ï¼Ÿé‚„æ˜¯è‡ªå·±æ‘¸ç´¢ï¼Ÿã€",
          "ã€Œæœ‰æ²’æœ‰å“ªä¸€æ¬¡ï¼Œä½ ä¸€é–‹å§‹å®Œå…¨ä¸æ‡‚ï¼Œä½†å¾Œä¾†çœŸçš„å­¸æœƒä¸¦èƒ½ç¨ç«‹å®Œæˆï¼Ÿé‚£å€‹éç¨‹æ˜¯æ€æ¨£ï¼Ÿã€"
        ],
        notes: [
          "æœ‰æ²’æœ‰å…·é«”å­¸ç¿’è¡Œç‚ºï¼ˆçœ‹æ›¸ã€ç·šä¸Šèª²ç¨‹ã€å•å‰è¼©ã€è‡ªå·±è©¦ï¼‰ã€‚",
          "æ˜¯è¢«å‹•ç­‰äººæ•™ï¼Œé‚„æ˜¯æœƒä¸»å‹•æ‰¾è³‡æ–™ã€‚",
          "å°ã€Œä¸æœƒã€é€™ä»¶äº‹çš„æ…‹åº¦ï¼Œæ˜¯é€ƒé¿é‚„æ˜¯é¡˜æ„é¢å°ã€‚"
        ]
      },
      soft_comm: {
        questions: [
          "ã€Œä½ æ›¾ç¶“éœ€è¦æŠŠä¸€ä»¶è¤‡é›œçš„äº‹æƒ…ï¼Œèªªæ˜çµ¦ä¸æ˜¯è©²é ˜åŸŸçš„äººè½å—ï¼Ÿä½ ç•¶æ™‚æ€éº¼è¬›ï¼Ÿã€",
          "ã€Œéå»æœ‰æ²’æœ‰è·ŸåŒäº‹æˆ–ä¸»ç®¡åœ¨æºé€šä¸Šç”¢ç”Ÿèª¤æœƒï¼Ÿå¾Œä¾†æ˜¯æ€éº¼è™•ç†å’ŒåŒ–è§£ï¼Ÿã€",
          "ã€Œå¦‚æœä½ è¦ºå¾—ä¸»ç®¡çš„æŒ‡ä»¤ä¸å¤ªåˆç†ï¼Œä½ æœƒæ€éº¼è™•ç†ï¼Ÿã€"
        ],
        notes: [
          "ä»–åœ¨æè¿°æ™‚æ˜¯ä¸æ˜¯æœ‰æ¢ç†ã€æœƒä¸æœƒä¸€ç›´ç¹åœˆå­ã€‚",
          "é¢å°è¡çªï¼Œæ˜¯æºé€šã€å†·è™•ç†ï¼Œé‚„æ˜¯ç¡¬ç¢°ç¡¬ã€‚",
          "å°å‘ä¸Šæºé€šçš„æ…‹åº¦ï¼ˆæ•¢ä¸æ•¢ææ„è¦‹ï¼Œæœ‰æ²’æœ‰æ–¹æ³•ï¼‰ã€‚"
        ]
      },
      soft_team: {
        questions: [
          "ã€Œåˆ†äº«ä¸€å€‹ä½ å’Œåœ˜éšŠä¸€èµ·å®Œæˆçš„å°ˆæ¡ˆï¼ä»»å‹™ï¼Œä½ åœ¨å…¶ä¸­æ‰®æ¼”ä»€éº¼è§’è‰²ï¼Ÿã€",
          "ã€Œå¦‚æœåœ˜éšŠè£¡æœ‰äººé€²åº¦è½å¾Œï¼Œå½±éŸ¿æ•´é«”æ™‚ç¨‹ï¼Œä½ æœƒæ€éº¼åšï¼Ÿã€",
          "ã€Œä½ èªç‚ºä½ çš„ç®¡ç†é¢¨æ ¼åå‘å¦‚ä½•ï¼Ÿã€"
        ],
        notes: [
          "æœƒä¸æœƒåªå¼·èª¿ã€Œæˆ‘ã€æˆ‘ã€æˆ‘ã€ï¼Œå®Œå…¨å¿½ç•¥åœ˜éšŠã€‚",
          "æ˜¯å¦é¡˜æ„æ”¯æ´ä»–äººã€å”èª¿ï¼Œè€Œä¸æ˜¯åªæœƒæŠ±æ€¨ã€‚",
          "æ˜¯å¦èƒ½å€åˆ†è·è²¬è·Ÿæƒ…ç·’ï¼Œä¸æŠŠæƒ…ç·’ç•¶ä¸»è§’ã€‚"
        ]
      },
      soft_time: {
        questions: [
          "ã€Œä½ ä¸€å¤©çš„å·¥ä½œé€šå¸¸æ€éº¼å®‰æ’ï¼Ÿæœ‰æ²’æœ‰è‡ªå·±çš„ä¸€å¥—æ–¹æ³•ï¼Ÿã€",
          "ã€Œç•¶åŒæ™‚æœ‰ä¸‰ä»¶äº‹æƒ…éƒ½å¾ˆæ€¥ï¼Œä½ æœƒæ€éº¼æ’å„ªå…ˆé †åºï¼Ÿã€",
          "ã€Œæœ‰æ²’æœ‰éäº¤ä¸å‡ºä¾†ã€delay çš„æƒ…æ³ï¼Ÿé‚£æ¬¡ç™¼ç”Ÿä»€éº¼äº‹ï¼Ÿä½ å¾Œä¾†æ€éº¼é¿å…å†ç™¼ç”Ÿï¼Ÿã€"
        ],
        notes: [
          "æœ‰æ²’æœ‰è‡ªå·±ç®¡ç†å¾…è¾¦äº‹é …çš„æ–¹æ³•ï¼ˆç­†è¨˜æœ¬ã€ç³»çµ±ã€Excelâ€¦ï¼‰ã€‚",
          "é¢å°æ€¥ä»¶æ™‚æœƒä¸æœƒæ…Œäº‚ï¼Œé‚„æ˜¯çŸ¥é“å…ˆè™•ç†ä»€éº¼ã€‚",
          "å°å»¶èª¤æ˜¯å¦èª å¯¦ã€æœƒä¸æœƒæª¢è¨è‡ªå·±ã€‚"
        ]
      },
      soft_stress: {
        questions: [
          "ã€Œä½ åœ¨éå»å·¥ä½œä¸­å£“åŠ›æœ€å¤§çš„ä¸€æ®µæ™‚é–“æ˜¯ä»€éº¼ç‹€æ³ï¼Ÿç•¶æ™‚å£“åŠ›ä¾†æºæ˜¯ä»€éº¼ï¼Ÿæ€éº¼æ’éå»çš„ï¼Ÿã€",
          "ã€Œå¦‚æœä¸»ç®¡è‡¨æ™‚åœ¨ä¸‹ç­å‰ä¸Ÿä¸€å€‹ç·Šæ€¥ä»»å‹™çµ¦ä½ ï¼Œä½ æœƒæ€éº¼è™•ç†ï¼Ÿã€",
          "ã€Œä½ å¹³å¸¸æœ‰æ²’æœ‰è‡ªå·±çš„ç´“å£“æ–¹å¼ï¼Ÿä¾‹å¦‚é‹å‹•ã€èˆˆè¶£ç­‰ç­‰ï¼Ÿã€"
        ],
        notes: [
          "å£“åŠ›å¤§çš„ä¾‹å­æ˜¯å¦çœŸå¯¦ï¼Œè€Œä¸æ˜¯è¬›å¾ˆå¹³æ·¡çš„å°äº‹ã€‚",
          "é¢å°å£“åŠ›æ™‚ï¼Œæ˜¯å´©æ½°ã€é€ƒé¿ï¼Œé‚„æ˜¯æœƒå°‹æ±‚è³‡æºï¼æ’å„ªå…ˆé †åºã€‚",
          "æœ‰æ²’æœ‰å»ºç«‹å€‹äººèª¿é©æ–¹å¼ï¼ˆä¸æ˜¯ä¸€å®šè¦å¾ˆå²å®³ï¼Œä½†è¦æœ‰è‡ªè¦ºï¼‰ã€‚"
        ]
      },
      mgmt_team: {
        questions: [
          "ã€Œä½ æœ€è¿‘ä¸€æ¬¡ç®¡ç†çš„åœ˜éšŠè¦æ¨¡å¤šå¤§ï¼Ÿå¦‚ä½•åˆ†å·¥èˆ‡è¨­å®šç›®æ¨™ï¼Ÿã€",
          "ã€Œå¦‚æœéƒ¨å±¬è¡¨ç¾ä¸€ç›´ä¸å¥½ï¼Œä½ æœƒæ€éº¼è™•ç†ï¼Ÿå¯ä»¥åˆ†äº«å¯¦éš›æ¡ˆä¾‹å—ï¼Ÿã€",
          "ã€Œåœ˜éšŠåœ¨é‡è¦å°ˆæ¡ˆè½å¾Œæ™‚ï¼Œä½ æœƒå…ˆåšå“ªå¹¾ä»¶äº‹ï¼Ÿã€"
        ],
        notes: [
          "ç¢ºèªæ˜¯å¦å…·å‚™å¯¦éš›å¸¶äººç¶“é©—ï¼Œè€Œéåªè«‡å€‹äººè²¢ç»ã€‚",
          "æ˜¯å¦æœƒè¨­å®šç›®æ¨™ã€è¿½è¹¤é€²åº¦ä¸¦é©æ™‚èª¿æ•´ç­–ç•¥ã€‚",
          "é¢å°ç¸¾æ•ˆä¸ä½³çš„äººï¼Œæ˜¯å¦æœ‰æ•™ç·´èˆ‡å›é¥‹ï¼Œè€Œä¸æ˜¯åªæƒ³æ›äººã€‚"
        ]
      },
      mgmt_process: {
        questions: [
          "ã€Œä½ æ›¾ç¶“æ”¹å–„éå“ªå€‹æµç¨‹ï¼Ÿå¦‚ä½•ç™¼ç¾å•é¡Œä¸¦æ¨å‹•è®Šé©ï¼Ÿã€",
          "ã€Œå¦‚æœæ–°å…¬å¸æ–‡ä»¶èˆ‡ SOP å¾ˆé›¶æ•£ï¼Œä½ æœƒæ€éº¼é–‹å§‹æ•´ç†ï¼Ÿã€",
          "ã€Œæœ‰æ²’æœ‰ä¸»å°åˆ¶åº¦å»ºç«‹æˆ–å„ªåŒ–ä¸¦æˆåŠŸè½åœ°çš„æ¡ˆä¾‹ï¼Ÿã€"
        ],
        notes: [
          "æ˜¯å¦æœƒå…ˆäº†è§£ç¾æ³ã€è’é›†è³‡æ–™å¾Œå†æå‡ºæ–¹æ¡ˆã€‚",
          "æœ‰æ²’æœ‰è©¦è¡Œã€èª¿æ•´ã€æ•™è‚²è¨“ç·´ç­‰æ¨å‹•éç¨‹ã€‚",
          "èƒ½å¦ç«™åœ¨ä½¿ç”¨è€…è§’åº¦è®“åˆ¶åº¦æ›´å¥½ç”¨ï¼Œè€Œéåªé¡§è‡ªå·±ã€‚"
        ]
      },
      mgmt_talent: {
        questions: [
          "ã€Œä½ å¸¶æ–°äººæˆ–æ¥ç­äººçš„ç­–ç•¥æ˜¯ä»€éº¼ï¼Ÿæœƒæ€éº¼å®‰æ’å­¸ç¿’é€²åº¦ï¼Ÿã€",
          "ã€Œç•¶éƒ¨å±¬ç¸½å•åŒæ¨£çš„å•é¡Œæ™‚ï¼Œä½ æœƒå¦‚ä½•å”åŠ©ä»–æˆé•·ï¼Ÿã€",
          "ã€Œåˆ†äº«ä¸€æ¬¡è·¨éƒ¨é–€å”èª¿ã€ä¸€é–‹å§‹å°æ–¹ä¸é…åˆä½†æœ€å¾Œå®Œæˆçš„æ¡ˆä¾‹ã€‚ã€"
        ],
        notes: [
          "æ˜¯å¦æœ‰å…·é«”åŸ¹è‚²æ–¹æ³•ï¼ˆé™ªè·‘ã€æ•™æã€å®šæœŸå›é¥‹ç­‰ï¼‰ã€‚",
          "é‡åˆ°è·¨éƒ¨é–€è¡çªæ™‚æ˜¯å¦é¡˜æ„æ›ä½æ€è€ƒä¸¦å°‹æ‰¾å…±åŒç›®æ¨™ã€‚",
          "èƒ½å¦æ•´åˆå¤šéƒ¨é–€è³‡æºï¼Œå…¼é¡§åœ˜éšŠèˆ‡å…¬å¸æ•´é«”åˆ©ç›Šã€‚"
        ]
      },
      perf_response: {
        questions: [
          "ã€Œå¦‚æœä»Šå¤©ä½ é€²å…¬å¸å¾Œï¼Œä¸»ç®¡è‡¨æ™‚æŠŠä½ èª¿å»æ”¯æ´å¦å¤–ä¸€å€‹éƒ¨é–€ï¼Œä½ æœƒæ€éº¼çœ‹å¾…é€™ä»¶äº‹ï¼Ÿã€",
          "ã€Œå‡è¨­æŸå€‹æµç¨‹çªç„¶å‡ºå•é¡Œï¼Œå¤§å®¶éƒ½åœ¨å•æ€éº¼è¾¦ï¼Œä½ æœƒå…ˆåšä»€éº¼ï¼Ÿã€",
          "ã€Œå¦‚æœå®¢æˆ¶ï¼å…§éƒ¨åŒä»æƒ…ç·’æ¯”è¼ƒæ¿€å‹•ï¼Œä½ æœƒæ€éº¼æ‡‰å°ï¼Ÿã€"
        ],
        notes: [
          "å›ç­”æ˜¯ä¸æ˜¯èƒ½å¿«é€ŸæŠ“åˆ°é‡é»ï¼Œè€Œä¸æ˜¯ç­”éæ‰€å•ã€‚",
          "é¢å°å‡è¨­æƒ…å¢ƒæ˜¯å¦èƒ½æœ‰å…·é«”åšæ³•ã€‚",
          "é¢è©¦éç¨‹ä¸­ï¼Œè‡¨æ™‚æ”¹è®Šå•é¡Œï¼Œä»–æœƒä¸æœƒæ…Œæ‰ã€‚"
        ]
      },
      perf_attitude: {
        questions: [
          "ã€Œä½ ç†æƒ³ä¸­çš„å¥½å·¥ä½œç’°å¢ƒæ˜¯ä»€éº¼æ¨£å­ï¼Ÿæœ‰å“ªäº›å…ƒç´ æ˜¯ä½ å¾ˆåœ¨æ„çš„ï¼Ÿã€",
          "ã€Œé‡åˆ°ä½ ä¸å–œæ­¡ä½†å¿…é ˆå®Œæˆçš„å·¥ä½œï¼Œä½ æœƒæ€éº¼èª¿æ•´å¿ƒæ…‹ï¼Ÿã€"
        ],
        notes: [
          "æ˜¯å¦åªæƒ³æº–æ™‚ä¸Šä¸‹ç­ã€ä¸è¦éº»ç…©ï¼Œé‚„æ˜¯èƒ½æ¥å—åˆç†çš„å½ˆæ€§ã€‚",
          "å°é›œäº‹ã€å°äº‹çš„æ…‹åº¦ï¼Œæ˜¯æŠ—æ‹’é‚„æ˜¯é¡˜æ„æ‰›ã€‚",
          "å°å…¬å¸ã€ç”¢æ¥­æœ‰æ²’æœ‰åŸºæœ¬å°Šé‡èˆ‡èˆˆè¶£ã€‚"
        ]
      },
      perf_manner: {
        questions: [
          "ã€Œä»Šå¤©çŸ¥é“è¦ä¾†é¢è©¦ï¼Œæˆ‘çœ‹ä½ æº–å‚™å¾—æ»¿æ•´é½Šçš„ï¼Œä½ æ˜¯æ€éº¼çœ‹å¾…ã€å°ˆæ¥­å½¢è±¡ã€é€™ä»¶äº‹ï¼Ÿã€",
          "ã€Œä½ è¦ºå¾—åœ¨è¾¦å…¬å®¤è£¡ï¼Œä»€éº¼æ¨£çš„ç¦®è²Œæˆ–åŸºæœ¬è¦ç¯„æ˜¯å¾ˆé‡è¦çš„ï¼Ÿã€"
        ],
        notes: [
          "æœè£æ˜¯å¦ç¬¦åˆå…¬å¸æ–‡åŒ–ï¼ˆä¸ç”¨ä¸€å®šè¥¿è£ï¼Œä½†è‡³å°‘ä¹¾æ·¨ã€å¾—é«”ï¼‰ã€‚",
          "èªæ°£ã€çœ¼ç¥ã€åå§¿æ˜¯å¦å°Šé‡ã€å°ˆæ³¨ã€‚",
          "é€²å‡ºæœƒè­°å®¤æ˜¯å¦æœƒæ•²é–€ã€èªªè¬è¬ç­‰åŸºæœ¬ç¦®å„€ã€‚"
        ]
      }
    };

    const starConfigs = {
      basic_resume_score: {
        left: "è³‡è¨Šé›¶æ•£",
        middle: "å®Œæ•´æ¸…æ¥š",
        right: "äº®é»çªå‡º"
      },
      basic_edu_score: {
        left: "å°ˆæ¥­ä¸ç¬¦",
        middle: "ç›¸é—œè¸å¯¦",
        right: "é«˜åº¦åŒ¹é…"
      },
      basic_exp_score: {
        left: "ç¶“é©—è½å·®",
        middle: "ç¬¦åˆéœ€æ±‚",
        right: "é«˜åº¦ç›¸ç¬¦"
      },
      basic_stability_score: {
        left: "é »ç¹è·³æ§½",
        middle: "ç†ç”±åˆç†",
        right: "ç©©å®šä¸€è‡´"
      },
      pro_tech_score: {
        left: "æŠ€èƒ½éœ€è£œå¼·",
        middle: "èƒ½ç¨ç«‹åŸ·è¡Œ",
        right: "å°ˆå®¶é ˜åŸŸ"
      },
      pro_problem_score: {
        left: "ç¼ºå°‘è§£æ³•",
        middle: "æ‹†è§£ä¸¦è½åœ°",
        right: "ä¸»å‹•å„ªåŒ–"
      },
      pro_learning_score: {
        left: "å­¸ç¿’è¢«å‹•",
        middle: "å¿«é€Ÿä¸Šæ‰‹",
        right: "è‡ªæˆ‘è¿­ä»£"
      },
      mgmt_team_score: {
        left: "ç¼ºä¹å¸¶äºº",
        middle: "èƒ½ç®¡æ—¥å¸¸",
        right: "æ¿€å‹µåœ˜éšŠ"
      },
      mgmt_process_score: {
        left: "æµç¨‹é¬†æ•£",
        middle: "å„ªåŒ–è½åœ°",
        right: "åˆ¶åº¦è¨­è¨ˆ"
      },
      mgmt_talent_score: {
        left: "å°‘è‚²æˆç¶“é©—",
        middle: "æ•™ç·´å›é¥‹",
        right: "è‚²æˆé«˜æ‰‹"
      },
      soft_comm_score: {
        left: "è¡¨é”å¤±ç„¦",
        middle: "æ¸…æ¥šè½èªª",
        right: "å½±éŸ¿åŠ›å¼·"
      },
      soft_team_score: {
        left: "åˆä½œæŠ—æ‹’",
        middle: "é…åˆå”ä½œ",
        right: "ä¸»å‹•å”èª¿"
      },
      soft_time_score: {
        left: "å¸¸å»¶èª¤",
        middle: "é€²åº¦å®ˆæ™‚",
        right: "å–„æ’å„ªå…ˆ"
      },
      soft_stress_score: {
        left: "æŠ—å£“åå¼±",
        middle: "ç©©å®šæ‡‰å°",
        right: "å£“åŠ›åŠ åˆ†"
      },
      perf_response_score: {
        left: "åæ‡‰é²ç·©",
        middle: "èšç„¦æ‡‰å°",
        right: "æ•æ·è§£æ³•"
      },
      perf_attitude_score: {
        left: "æ…‹åº¦æ¶ˆæ¥µ",
        middle: "å‹™å¯¦æ­£å‘",
        right: "ä¸»å‹•æ‰¿æ“”"
      },
      perf_manner_score: {
        left: "ç¦®å„€ä¸è¶³",
        middle: "åŸºæœ¬å¾—é«”",
        right: "å°ˆæ¥­æœ‰å‹"
      }
    };

    const roleWeights = {
      general: { basic: 15, professional: 35, management: 0, soft: 35, performance: 15 },
      professional: { basic: 15, professional: 40, management: 0, soft: 30, performance: 15 },
      manager: { basic: 15, professional: 35, management: 20, soft: 20, performance: 10 }
    };

    const scoreSections = {
      basic: [
        { id: "basic_resume_score", max: 10 },
        { id: "basic_edu_score", max: 10 },
        { id: "basic_exp_score", max: 10 },
        { id: "basic_stability_score", max: 10 }
      ],
      professional: [
        { id: "pro_tech_score", max: 10 },
        { id: "pro_problem_score", max: 10 },
        { id: "pro_learning_score", max: 10 }
      ],
      management: [
        { id: "mgmt_team_score", max: 10 },
        { id: "mgmt_process_score", max: 10 },
        { id: "mgmt_talent_score", max: 10 }
      ],
      soft: [
        { id: "soft_comm_score", max: 10 },
        { id: "soft_team_score", max: 10 },
        { id: "soft_time_score", max: 10 },
        { id: "soft_stress_score", max: 10 }
      ],
      performance: [
        { id: "perf_response_score", max: 10 },
        { id: "perf_attitude_score", max: 10 },
        { id: "perf_manner_score", max: 10 }
      ]
    };

    const starUpdaters = {};

    function createStarRating(id, labels) {
      const container = document.querySelector(`[data-star-for='${id}']`);
      const input = document.getElementById(id);
      if (!container || !input) return;

      const starRow = document.createElement("div");
      starRow.className = "star-row";
      for (let i = 0; i <= 10; i++) {
        const star = document.createElement("span");
        star.className = "star";
        star.dataset.value = i;
        star.textContent = "â˜…";
        starRow.appendChild(star);
      }

      const labelRow = document.createElement("div");
      labelRow.className = "star-labels";
      labelRow.innerHTML = `
        <span>${labels.left}</span>
        <span class="mid">${labels.middle}</span>
        <span>${labels.right}</span>
      `;

      container.appendChild(starRow);
      container.appendChild(labelRow);

      const updateStars = (value) => {
        starRow.querySelectorAll(".star").forEach((star) => {
          const starValue = Number(star.dataset.value);
          star.classList.toggle("active", !Number.isNaN(value) && starValue <= value);
        });
      };

      starRow.addEventListener("click", (event) => {
        const target = event.target.closest(".star");
        if (!target || input.disabled) return;
        const value = Number(target.dataset.value);
        input.value = value;
        input.dispatchEvent(new Event("change", { bubbles: true }));
        updateStars(value);
      });

      input.addEventListener("change", () => {
        const value = parseInt(input.value, 10);
        updateStars(Number.isNaN(value) ? -1 : value);
      });

      updateStars(parseInt(input.value, 10));
      starUpdaters[id] = updateStars;
    }

    Object.entries(starConfigs).forEach(([id, labels]) =>
      createStarRating(id, labels)
    );

    const discDescriptions = {
      D: {
        title: "æ”¯é…å‹ï¼ˆDï¼‰- è€è™",
        traits:
          "ç›®æ¨™å°å‘ã€è¡Œå‹•è¿…é€Ÿã€æœ‰æ±ºæ–·åŠ›ï¼Œå–œæ­¡æŒ‘æˆ°ä¸¦å‹‡æ–¼æ‰¿æ“”é¢¨éšªã€‚",
        jobs:
          "é ˜å°è€…ã€ç®¡ç†è€…ã€å±æ©Ÿè™•ç†ã€å°ˆæ¡ˆæ¨å‹•ã€éœ€è¦é”æˆç›®æ¨™çš„éŠ·å”®æˆ–é–‹ç™¼è·ä½ã€‚"
      },
      I: {
        title: "å½±éŸ¿å‹ï¼ˆIï¼‰- å­”é›€",
        traits:
          "ç†±æƒ…æœ‰æ´»åŠ›ã€å–„æ–¼æºé€šã€èƒ½æ¿€å‹µä»–äººï¼Œæ¨‚æ–¼åœ¨åœ˜éšŠä¸­äº’å‹•ã€‚",
        jobs:
          "æ¥­å‹™ã€è¡ŒéŠ·ã€å…¬é—œã€äººè³‡ã€éœ€è¦å¤§é‡äººéš›äº’å‹•èˆ‡å”ä½œçš„è·ä½ã€‚"
      },
      S: {
        title: "ç©©å¥å‹ï¼ˆSï¼‰- ç„¡å°¾ç†Š",
        traits:
          "å†·éœæº«å’Œã€è™•äº‹åœ“èã€å¿ èª å¯ä¿¡è³´ï¼Œåå¥½ç©©å®šå¯é æ¸¬çš„å·¥ä½œæ­¥èª¿ã€‚",
        jobs:
          "å®¢æˆ¶æœå‹™ã€æ•™è‚²ã€è¡Œæ”¿ã€åœ˜éšŠåˆä½œå‹çš„å°ˆæ¡ˆæ”¯æ´ï¼Œæˆ–æ˜¯åœ¨é ˜å°å¸¶é ˜ä¸‹åŸ·è¡Œä»»å‹™ã€‚"
      },
      C: {
        title: "è¬¹æ…å‹ï¼ˆCï¼‰- è²“é ­é·¹",
        traits:
          "é‚è¼¯æ€§å¼·ã€åˆ†æåŠ›ä½³ã€ç´°å¿ƒè¬¹æ…ï¼Œé‡è¦–è¦å‰‡èˆ‡ç´°ç¯€ã€‚",
        jobs:
          "è²¡å‹™ã€æœƒè¨ˆã€å°ˆæ¡ˆç®¡ç†ã€ç ”ç©¶å“¡ã€å“ç®¡ç­‰éœ€è¦ç²¾ç¢ºæ€§å’Œåˆ†æåŠ›çš„å·¥ä½œã€‚"
      }
    };

    function anyModalOpen() {
      return Array.from(document.querySelectorAll(".modal-backdrop")).some(
        (modal) => !modal.classList.contains("hidden")
      );
    }

    function openModal(modal) {
      if (!modal) return;
      modal.classList.remove("hidden");
      document.body.classList.add("modal-open");
    }

    function closeModal(modal) {
      if (!modal) return;
      modal.classList.add("hidden");
      if (!anyModalOpen()) {
        document.body.classList.remove("modal-open");
      }
    }

    function renderGuidelineList(target, items) {
      if (!target) return;
      if (!items || !items.length) {
        target.innerHTML = "<li>â€”</li>";
        return;
      }
      target.innerHTML = items.map((text) => `<li>${text}</li>`).join("");
    }

    function openGuidelineModal(key, label) {
      if (!guidelineModal) return;
      const info = guidelineData[key];
      if (!info) return;
      guidelineModalTitle.textContent = label || "é¢è©¦æå•å»ºè­°";
      renderGuidelineList(guidelineModalQuestions, info.questions);
      renderGuidelineList(guidelineModalNotes, info.notes);
      openModal(guidelineModal);
    }

    function closeGuidelineModal() {
      closeModal(guidelineModal);
    }

    guidelineToggles.forEach((btn) => {
      btn.addEventListener("click", () => {
        openGuidelineModal(btn.dataset.guideline, btn.dataset.guidelineTitle);
      });
    });

    modalCloseButtons.forEach((btn) =>
      btn.addEventListener("click", () => {
        const modal = btn.closest(".modal-backdrop");
        closeModal(modal);
      })
    );

    document.querySelectorAll(".modal-backdrop").forEach((modal) => {
      modal.addEventListener("click", (event) => {
        if (event.target === modal) {
          closeModal(modal);
        }
      });
    });

    if (openScoreStandardBtn && scoreStandardModal) {
      openScoreStandardBtn.addEventListener("click", () => {
        openModal(scoreStandardModal);
      });
    }

    function getCurrentRoleType() {
      if (!roleTypeSelect) return "general";
      return roleTypeSelect.value || "general";
    }

    function calculateSectionRatio(sectionKey) {
      const fields = scoreSections[sectionKey];
      if (!fields) return 0;
      let sum = 0;
      let maxSum = 0;
      fields.forEach(({ id, max }) => {
        const el = document.getElementById(id);
        if (!el) return;
        const val = parseInt(el.value, 10);
        if (!isNaN(val)) {
          sum += val;
        }
        maxSum += max;
      });
      return maxSum ? sum / maxSum : 0;
    }

    function updateTotalScore() {
      const roleType = getCurrentRoleType();
      const weights = roleWeights[roleType] || roleWeights.general;
      let total = 0;
      Object.keys(scoreSections).forEach((sectionKey) => {
        const ratio = calculateSectionRatio(sectionKey);
        const weight = weights[sectionKey] || 0;
        total += ratio * weight;
      });
      const hasScore = Array.from(scoreInputs).some(
        (input) => !Number.isNaN(parseInt(input.value, 10))
      );
      const rounded = Math.round(total * 10) / 10;
      if (hasScore) {
        totalScoreEl.textContent = Number.isInteger(rounded)
          ? String(rounded)
          : rounded.toFixed(1);
      } else {
        totalScoreEl.textContent = "â€”";
      }
    }

    function updateRoleLocks() {
      const locked = !roleTypeSelect || !roleTypeSelect.value;
      roleLockedFields.forEach((field) => {
        const wrapper = field.closest(".field");
        field.disabled = locked;
        if (locked) {
          if (field.type === "radio" || field.type === "checkbox") {
            field.checked = false;
          } else {
            field.value = "";
          }
        }
        if (wrapper) {
          wrapper.dataset.disabled = locked ? "true" : "false";
        }
      });
    }

    function updateWeightLabels() {
      const roleType = getCurrentRoleType();
      const weights = roleWeights[roleType] || roleWeights.general;
      weightLabels.forEach((label) => {
        const key = label.dataset.weightLabel;
        const weight = weights[key] ?? 0;
        label.textContent = weight > 0 ? `æ¬Šé‡ï¼š${weight}%` : "æœªç´å…¥æ¬Šé‡";
      });
    }

    function toggleManagementSection() {
      const isManager = getCurrentRoleType() === "manager";
      if (managementSection) {
        managementSection.classList.toggle("hidden", !isManager);
      }
      managementScoreInputs.forEach((input) => {
        input.disabled = !isManager;
        if (!isManager) {
          input.value = "";
          input.dispatchEvent(new Event("change", { bubbles: true }));
        }
      });
      managementCommentInputs.forEach((textarea) => {
        textarea.disabled = !isManager;
        if (!isManager) {
          textarea.value = "";
        }
      });
    }

    function updateRoleDisplay() {
      updateRoleLocks();
      toggleManagementSection();
      updateWeightLabels();
      updateTotalScore();
    }

    scoreInputs.forEach((sel) => {
      sel.addEventListener("change", updateTotalScore);
    });

    if (roleTypeSelect) {
      roleTypeSelect.addEventListener("change", updateRoleDisplay);
    }

    function updateAiToolsVisibility() {
      const usingAi =
        (document.querySelector("input[name='ai_usage']:checked") || {})
          .value === "yes";
      aiToolsWrapper.classList.toggle("hidden", !usingAi);
      if (!usingAi) {
        aiToolCheckboxes.forEach((cb) => (cb.checked = false));
        aiOtherInput.value = "";
      }
      return usingAi;
    }

    aiUsageInputs.forEach((input) =>
      input.addEventListener("change", updateAiToolsVisibility)
    );

    function updateErpOtherInput() {
      if (!erpOtherInput) return;
      const shouldShow = erpOtherCheckbox && erpOtherCheckbox.checked;
      erpOtherInput.classList.toggle("hidden", !shouldShow);
      if (!shouldShow) {
        erpOtherInput.value = "";
      }
    }

    function updateErpVisibility() {
      const hasExperience = Array.from(erpExperienceRadios).some(
        (radio) => radio.checked && radio.value === "yes"
      );
      if (erpDetails) {
        erpDetails.classList.toggle("hidden", !hasExperience);
      }
      if (!hasExperience) {
        erpOptions.forEach((cb) => (cb.checked = false));
        if (erpOtherInput) erpOtherInput.value = "";
      }
      updateErpOtherInput();
      return hasExperience;
    }

    erpExperienceRadios.forEach((radio) =>
      radio.addEventListener("change", updateErpVisibility)
    );

    if (erpOtherCheckbox) {
      erpOtherCheckbox.addEventListener("change", updateErpOtherInput);
    }

    function getSelectedAiTools() {
      const tools = Array.from(aiToolCheckboxes)
        .filter((cb) => cb.checked)
        .map((cb) => cb.value);
      if (aiOtherInput.value.trim()) tools.push(aiOtherInput.value.trim());
      return tools;
    }

    function updateDiscInfo() {
      const type = discSelect.value;
      const info = discDescriptions[type];
      if (!info) {
        discResult.innerHTML =
          '<div class="disc-title">å°šæœªé¸æ“‡</div><div class="muted">é¸æ“‡ DISC é¡å‹å¾Œï¼Œç³»çµ±æœƒè‡ªå‹•å¸¶å‡ºäººæ ¼ç‰¹è³ªèˆ‡é©åˆçš„è·å ´æƒ…å¢ƒï¼Œæ–¹ä¾¿è¨˜éŒ„åœ¨ Wordã€‚</div>';
        return;
      }

      discResult.innerHTML = `
        <div class="disc-tag">${info.title}</div>
        <div class="disc-title">äººæ ¼ç‰¹è³ª</div>
        <div>${info.traits}</div>
        <div class="disc-title" style="margin-top:6px;">é©åˆçš„è·å ´æƒ…å¢ƒ</div>
        <div>${info.jobs}</div>
      `;
    }

    discSelect.addEventListener("change", updateDiscInfo);

    function updatePetVisibility() {
      const status = (document.querySelector("input[name='pet_status']:checked") || {})
        .value;
      const shouldShow = status === "yes" || status === "past";
      if (petTypesWrapper) {
        petTypesWrapper.classList.toggle("hidden", !shouldShow);
      }
      if (petFeederWrapper) {
        petFeederWrapper.classList.toggle("hidden", !shouldShow);
      }
      if (!shouldShow) {
        document
          .querySelectorAll("#petTypes input[type='checkbox']")
          .forEach((cb) => (cb.checked = false));
        document
          .querySelectorAll("input[name='pet_feeder']")
          .forEach((r) => (r.checked = false));
      }
    }

    petStatusInputs.forEach((input) =>
      input.addEventListener("change", updatePetVisibility)
    );

    function addQuestionNote(initialValue = "") {
      const note = document.createElement("div");
      note.className = "note-card";
      const toolbar = document.createElement("div");
      toolbar.className = "note-toolbar";
      const removeBtn = document.createElement("button");
      removeBtn.type = "button";
      removeBtn.className = "btn-remove-note";
      removeBtn.textContent = "åˆªé™¤æ­¤æå•";
      removeBtn.addEventListener("click", () => {
        note.remove();
        if (!questionList.children.length) {
          addQuestionNote();
        }
      });
      toolbar.appendChild(removeBtn);
      const textarea = document.createElement("textarea");
      textarea.placeholder = "è¼¸å…¥æå•å…§å®¹èˆ‡é¢è©¦å®˜ç­†è¨˜";
      textarea.value = initialValue;
      note.appendChild(toolbar);
      note.appendChild(textarea);
      questionList.appendChild(note);
    }

    addQuestionBtn.addEventListener("click", () => addQuestionNote());
    addQuestionNote();

    function resetForm() {
      if (!confirm("ç¢ºå®šè¦æ¸…ç©ºæ•´ä»½è©•åˆ†è¡¨å—ï¼Ÿ")) return;
      document.querySelectorAll("input, textarea, select").forEach((el) => {
        if (el.type === "radio" || el.type === "checkbox") {
          el.checked = false;
        } else {
          el.value = "";
        }
      });
      scoreInputs.forEach((input) =>
        input.dispatchEvent(new Event("change", { bubbles: true }))
      );
      if (roleTypeSelect) {
        roleTypeSelect.value = "";
      }
      updateRoleDisplay();
      updateAiToolsVisibility();
      updateErpVisibility();
      updateDiscInfo();
      updatePetVisibility();
      closeGuidelineModal();
      questionList.innerHTML = "";
      addQuestionNote();
    }

    function safeText(text) {
      if (!text) return "";
      return text.replace(/&/g, "&amp;")
                 .replace(/</g, "&lt;")
                 .replace(/>/g, "&gt;")
                 .replace(/"/g, "&quot;");
    }

    function formatMultiline(text) {
      return safeText(text || "").replace(/\n/g, "<br>");
    }

    function getInterviewQuestions() {
      return Array.from(questionList.querySelectorAll("textarea"))
        .map((ta) => ta.value.trim())
        .filter((v) => v);
    }

    function getPetTypes() {
      return Array.from(
        document.querySelectorAll("#petTypes input[type='checkbox']")
      )
        .filter((cb) => cb.checked)
        .map((cb) => cb.value);
    }

    function getErpSelections() {
      const selections = [];
      erpOptions.forEach((cb) => {
        if (!cb.checked) return;
        if (cb.dataset.other) {
          const otherValue = (erpOtherInput.value || "").trim();
          selections.push(otherValue || "å…¶ä»–ï¼ˆæœªå¡«ï¼‰");
        } else {
          selections.push(cb.value);
        }
      });
      return selections;
    }

    function exportToWord() {
      updateTotalScore();

      const data = {
        candidateName: document.getElementById("candidateName").value || "",
        position: document.getElementById("position").value || "",
        role_type: roleTypeSelect ? roleTypeSelect.value : "",
        interviewDate: document.getElementById("interviewDate").value || "",
        interviewer: document.getElementById("interviewer").value || "",
        interviewParticipants:
          document.getElementById("interviewParticipants").value || "",
        company_motivation: document.getElementById("company_motivation").value,
        achievement_note: document.getElementById("achievement_note").value,
        challenge_note: document.getElementById("challenge_note").value,
        strength_primary: document.getElementById("strength_primary").value,
        strength_secondary: document.getElementById("strength_secondary").value,
        weakness_primary: document.getElementById("weakness_primary").value,
        weakness_secondary: document.getElementById("weakness_secondary").value,
        ai_usage:
          (document.querySelector("input[name='ai_usage']:checked") || {})
            .value || "",
        ai_tools: getSelectedAiTools(),
        ai_other: aiOtherInput.value,
        erp_experience:
          (document.querySelector("input[name='erp_experience']:checked") || {})
            .value || "",
        erp_systems: getErpSelections(),
        erp_other: erpOtherInput.value,
        disc_type: discSelect.value,
        // åŸºæœ¬ä¿¡æ¯
        basic_resume_score: document.getElementById("basic_resume_score").value,
        basic_resume_comment: document.getElementById("basic_resume_comment").value,
        basic_edu_score: document.getElementById("basic_edu_score").value,
        basic_edu_comment: document.getElementById("basic_edu_comment").value,
        basic_exp_score: document.getElementById("basic_exp_score").value,
        basic_exp_comment: document.getElementById("basic_exp_comment").value,
        basic_stability_score: document.getElementById("basic_stability_score").value,
        basic_stability_comment: document.getElementById("basic_stability_comment").value,
        // å°ˆæ¥­èƒ½åŠ›
        pro_tech_score: document.getElementById("pro_tech_score").value,
        pro_tech_comment: document.getElementById("pro_tech_comment").value,
        pro_problem_score: document.getElementById("pro_problem_score").value,
        pro_problem_comment: document.getElementById("pro_problem_comment").value,
        pro_learning_score: document.getElementById("pro_learning_score").value,
        pro_learning_comment: document.getElementById("pro_learning_comment").value,
        // ç®¡ç†èƒ½åŠ›ï¼ˆä¸»ç®¡è·ï¼‰
        mgmt_team_score: document.getElementById("mgmt_team_score").value,
        mgmt_team_comment: document.getElementById("mgmt_team_comment").value,
        mgmt_process_score: document.getElementById("mgmt_process_score").value,
        mgmt_process_comment: document.getElementById("mgmt_process_comment").value,
        mgmt_talent_score: document.getElementById("mgmt_talent_score").value,
        mgmt_talent_comment: document.getElementById("mgmt_talent_comment").value,
        // è»ŸæŠ€èƒ½
        soft_comm_score: document.getElementById("soft_comm_score").value,
        soft_comm_comment: document.getElementById("soft_comm_comment").value,
        soft_team_score: document.getElementById("soft_team_score").value,
        soft_team_comment: document.getElementById("soft_team_comment").value,
        soft_time_score: document.getElementById("soft_time_score").value,
        soft_time_comment: document.getElementById("soft_time_comment").value,
        soft_stress_score: document.getElementById("soft_stress_score").value,
        soft_stress_comment: document.getElementById("soft_stress_comment").value,
        // é¢è©¦è¡¨ç¾
        perf_response_score: document.getElementById("perf_response_score").value,
        perf_response_comment: document.getElementById("perf_response_comment").value,
        perf_attitude_score: document.getElementById("perf_attitude_score").value,
        perf_attitude_comment: document.getElementById("perf_attitude_comment").value,
        perf_manner_score: document.getElementById("perf_manner_score").value,
        perf_manner_comment: document.getElementById("perf_manner_comment").value,
        // ç¸½è©•
        overall_comment: document.getElementById("overall_comment").value,
        signature: document.getElementById("signature").value,
        totalScore: totalScoreEl.textContent,
        // è£œå……è³‡æ–™
        pet_status:
          (document.querySelector("input[name='pet_status']:checked") || {})
            .value || "",
        pet_types: getPetTypes(),
        pet_feeder:
          (document.querySelector("input[name='pet_feeder']:checked") || {})
            .value || "",
        pet_note: document.getElementById("pet_note").value,
        interview_questions: getInterviewQuestions()
      };

      const aiToolsText = data.ai_usage === "yes" ? data.ai_tools.join("ã€") : "æœªä½¿ç”¨";
      const erpStatusMap = {
        yes: "æœ‰",
        no: "æ²’æœ‰"
      };
      const erpStatusText = erpStatusMap[data.erp_experience] || "æœªå¡«å¯«";
      const erpSystemsText =
        data.erp_experience === "yes"
          ? data.erp_systems.length
            ? data.erp_systems.join("ã€")
            : "æœªå¡«å¯«"
          : "â€”";

      const petStatusMap = {
        yes: "æœ‰",
        no: "æ²’æœ‰",
        past: "ä»¥å‰é¤Šé"
      };

      const petStatusText = petStatusMap[data.pet_status] || "æœªå¡«å¯«";
      const petTypesText = data.pet_types.length
        ? data.pet_types.join("ã€")
        : "â€”";
      const petFeederText = data.pet_feeder === "yes" ? "æ˜¯" : data.pet_feeder === "no" ? "å¦" : "æœªå¡«å¯«";
      const questionListHtml = data.interview_questions.length
        ? `<ul>${data.interview_questions
            .map((q) => `<li>${formatMultiline(q)}</li>`)
            .join("")}</ul>`
        : "<div class=\"muted\">æœªå¡«å¯«</div>";
      const roleTypeMap = {
        general: "ä¸€èˆ¬è·å‹™",
        professional: "å°ˆæ¥­è·å‹™",
        manager: "ä¸»ç®¡è·å‹™"
      };
      const roleTypeText = roleTypeMap[data.role_type] || "æœªé¸æ“‡";
      const isManagerRole = data.role_type === "manager";
      const managementSectionHtml = isManagerRole
        ? `
  <div class="section-title">ä¸»ç®¡è· â€” ç®¡ç†èƒ½åŠ›ï¼ˆæ»¿åˆ† 20 åˆ†ï¼‰</div>
  <table>
    <tr>
      <th class="border">é …ç›®</th>
      <th class="border">è©•åˆ†</th>
      <th class="border">è©•èª</th>
    </tr>
    <tr>
      <td class="border">åœ˜éšŠç®¡ç†èˆ‡æˆæ¬Šèƒ½åŠ›</td>
      <td class="border score-cell">${safeText(data.mgmt_team_score)}</td>
      <td class="border">${formatMultiline(data.mgmt_team_comment)}</td>
    </tr>
    <tr>
      <td class="border">åˆ¶åº¦èˆ‡æµç¨‹å»ºç«‹èƒ½åŠ›</td>
      <td class="border score-cell">${safeText(data.mgmt_process_score)}</td>
      <td class="border">${formatMultiline(data.mgmt_process_comment)}</td>
    </tr>
    <tr>
      <td class="border">äººæ‰åŸ¹è‚²èˆ‡è·¨éƒ¨é–€å”èª¿</td>
      <td class="border score-cell">${safeText(data.mgmt_talent_score)}</td>
      <td class="border">${formatMultiline(data.mgmt_talent_comment)}</td>
    </tr>
  </table>`
        : "";

      const htmlContent = `
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
  body { font-family: "Microsoft JhengHei", Arial, sans-serif; line-height: 1.6; color: #111827; }
  h2 { margin-top: 24px; margin-bottom: 8px; }
  table { width: 100%; border-collapse: collapse; margin-bottom: 16px; }
  th, td { padding: 8px 10px; text-align: left; }
  .border { border: 1px solid #d1d5db; }
  .score-cell { width: 80px; text-align: center; }
  .box-line { border-top: 1px solid #e5e7eb; margin: 12px 0; }
  .section-title { font-size: 16px; font-weight: 700; margin: 14px 0 6px; }
  .muted { color: #6b7280; }
  .signature-line { margin-top: 26px; }
</style>
</head>
<body>
  <h2>é¢è©¦è©•åˆ†è¡¨</h2>
  <p><strong>æ‡‰è˜è€…å§“åï¼š</strong> ${safeText(data.candidateName)}<br>
     <strong>é¢è©¦è·ä½ï¼š</strong> ${safeText(data.position)}<br>
     <strong>æ‡‰å¾µè·å‹™é¡å‹ï¼š</strong> ${safeText(roleTypeText)}<br>
     <strong>é¢è©¦æ—¥æœŸï¼š</strong> ${safeText(data.interviewDate)}<br>
     <strong>é¢è©¦å®˜ï¼š</strong> ${safeText(data.interviewer)}<br>
     <strong>é¢è©¦åƒèˆ‡è€…ï¼š</strong> ${formatMultiline(data.interviewParticipants || "æœªå¡«å¯«")}</p>

  <div class="section-title">ä¸€ã€åŸºæœ¬ä¿¡æ¯ï¼ˆæ¯é …æ»¿åˆ† 5 åˆ†ï¼‰</div>
  <table>
    <tr>
      <th class="border">é …ç›®</th>
      <th class="border">è©•åˆ†</th>
      <th class="border">è©•èª</th>
    </tr>
    <tr>
      <td class="border">å±¥æ­·å®Œæ•´åº¦</td>
      <td class="border score-cell">${safeText(data.basic_resume_score)}</td>
      <td class="border">${formatMultiline(data.basic_resume_comment)}</td>
    </tr>
    <tr>
      <td class="border">æ•™è‚²èƒŒæ™¯</td>
      <td class="border score-cell">${safeText(data.basic_edu_score)}</td>
      <td class="border">${formatMultiline(data.basic_edu_comment)}</td>
    </tr>
    <tr>
      <td class="border">å·¥ä½œç¶“æ­·</td>
      <td class="border score-cell">${safeText(data.basic_exp_score)}</td>
      <td class="border">${formatMultiline(data.basic_exp_comment)}</td>
    </tr>
    <tr>
      <td class="border">å·¥ä½œç©©å®šæ€§ï¼ˆå«é›¢è·åŸå› ï¼‰</td>
      <td class="border score-cell">${safeText(data.basic_stability_score)}</td>
      <td class="border">${formatMultiline(data.basic_stability_comment)}</td>
    </tr>
  </table>

  <div class="section-title">äºŒã€å°ˆæ¥­èƒ½åŠ›ï¼ˆæ¯é …æ»¿åˆ† 10 åˆ†ï¼‰</div>
  <table>
    <tr>
      <th class="border">é …ç›®</th>
      <th class="border">è©•åˆ†</th>
      <th class="border">è©•èª</th>
    </tr>
    <tr>
      <td class="border">æŠ€è¡“æŠ€èƒ½</td>
      <td class="border score-cell">${safeText(data.pro_tech_score)}</td>
      <td class="border">${formatMultiline(data.pro_tech_comment)}</td>
    </tr>
    <tr>
      <td class="border">å•é¡Œè§£æ±ºèƒ½åŠ›</td>
      <td class="border score-cell">${safeText(data.pro_problem_score)}</td>
      <td class="border">${formatMultiline(data.pro_problem_comment)}</td>
    </tr>
    <tr>
      <td class="border">å­¸ç¿’èƒ½åŠ›</td>
      <td class="border score-cell">${safeText(data.pro_learning_score)}</td>
      <td class="border">${formatMultiline(data.pro_learning_comment)}</td>
    </tr>
  </table>

  ${managementSectionHtml}

  <div class="section-title">ä¸‰ã€è»ŸæŠ€èƒ½ï¼ˆæ¯é …æ»¿åˆ† 10 åˆ†ï¼‰</div>
  <table>
    <tr>
      <th class="border">é …ç›®</th>
      <th class="border">è©•åˆ†</th>
      <th class="border">è©•èª</th>
    </tr>
    <tr>
      <td class="border">æºé€šèƒ½åŠ›</td>
      <td class="border score-cell">${safeText(data.soft_comm_score)}</td>
      <td class="border">${formatMultiline(data.soft_comm_comment)}</td>
    </tr>
    <tr>
      <td class="border">åœ˜éšŠåˆä½œ</td>
      <td class="border score-cell">${safeText(data.soft_team_score)}</td>
      <td class="border">${formatMultiline(data.soft_team_comment)}</td>
    </tr>
    <tr>
      <td class="border">æ™‚é–“ç®¡ç†</td>
      <td class="border score-cell">${safeText(data.soft_time_score)}</td>
      <td class="border">${formatMultiline(data.soft_time_comment)}</td>
    </tr>
    <tr>
      <td class="border">æŠ—å£“èƒ½åŠ›</td>
      <td class="border score-cell">${safeText(data.soft_stress_score)}</td>
      <td class="border">${formatMultiline(data.soft_stress_comment)}</td>
    </tr>
  </table>

  <div class="section-title">å››ã€é¢è©¦è¡¨ç¾ï¼ˆæ¯é …æ»¿åˆ† 5 åˆ†ï¼‰</div>
  <table>
    <tr>
      <th class="border">é …ç›®</th>
      <th class="border">è©•åˆ†</th>
      <th class="border">è©•èª</th>
    </tr>
    <tr>
      <td class="border">æ‡‰å°èƒ½åŠ›</td>
      <td class="border score-cell">${safeText(data.perf_response_score)}</td>
      <td class="border">${formatMultiline(data.perf_response_comment)}</td>
    </tr>
    <tr>
      <td class="border">è·æ¥­æ…‹åº¦</td>
      <td class="border score-cell">${safeText(data.perf_attitude_score)}</td>
      <td class="border">${formatMultiline(data.perf_attitude_comment)}</td>
    </tr>
    <tr>
      <td class="border">å„€è¡¨å„€æ…‹</td>
      <td class="border score-cell">${safeText(data.perf_manner_score)}</td>
      <td class="border">${formatMultiline(data.perf_manner_comment)}</td>
    </tr>
  </table>

  <div class="box-line"></div>

  <p><strong>ç¸½åˆ†ï¼ˆæ»¿åˆ† 100 åˆ†ï¼‰ï¼š</strong> ${safeText(data.totalScore)}</p>

  <p><strong>ç¸½è©• â€” ç¶œåˆè©•åƒ¹åŠå»ºè­°ï¼š</strong></p>
  <p>${formatMultiline(data.overall_comment)}</p>

  <div class="section-title">å€™é¸äººè‡ªè¿°èˆ‡è£œå……è³‡è¨Š</div>
  <p><strong>æŠ•éå‹•æ©Ÿèˆ‡å“ç‰Œç†è§£ï¼š</strong><br>${formatMultiline(data.company_motivation)}</p>
  <p><strong>æœ€æœ‰æˆå°±æ„Ÿçš„äº‹æƒ…èˆ‡ç¶“é©—ï¼š</strong><br>${formatMultiline(data.achievement_note)}</p>
  <p><strong>é‡åˆ°çš„æœ€å¤§æŒ«æŠ˜èˆ‡è§£æ³•ï¼š</strong><br>${formatMultiline(data.challenge_note)}</p>
  <p><strong>è‡ªè¿°çš„å„ªé» #1ï¼š</strong><br>${formatMultiline(data.strength_primary)}</p>
  <p><strong>è‡ªè¿°çš„å„ªé» #2ï¼š</strong><br>${formatMultiline(data.strength_secondary)}</p>
  <p><strong>è‡ªè¿°çš„ç¼ºé» #1ï¼š</strong><br>${formatMultiline(data.weakness_primary)}</p>
  <p><strong>è‡ªè¿°çš„ç¼ºé» #2ï¼š</strong><br>${formatMultiline(data.weakness_secondary)}</p>
  <p><strong>AI ä½¿ç”¨æƒ…æ³ï¼š</strong> ${safeText(aiToolsText)}</p>
  <p><strong>ERP ä½¿ç”¨ç¶“é©—ï¼š</strong> ${safeText(erpStatusText)}</p>
  <p><strong>ä½¿ç”¨éçš„ ERP ç³»çµ±ï¼š</strong> ${safeText(erpSystemsText)}</p>
  <p><strong>DISC é¡å‹ï¼š</strong> ${safeText(data.disc_type || "æœªå¡«å¯«")}</p>

  <div class="section-title">å¯µç‰©èˆ‡ç…§è­·è³‡è¨Š</div>
  <p><strong>æ˜¯å¦æœ‰é¤Šå¯µç‰©ï¼š</strong> ${safeText(petStatusText)}</p>
  <p><strong>å¯µç‰©é¡å‹ï¼š</strong> ${safeText(petTypesText)}</p>
  <p><strong>æ˜¯å¦ç‚ºé£¼æ–™æŒ‘é¸è€…ï¼š</strong> ${safeText(petFeederText)}</p>
  <p><strong>å¯µç‰©å‚™è¨»ï¼š</strong><br>${formatMultiline(data.pet_note)}</p>

  <div class="section-title">é¢è©¦è€…æå•</div>
  ${questionListHtml}

  <div class="box-line"></div>

  <p class="signature-line">
    é¢è©¦å®˜ç°½åï¼š __________________________
    &nbsp;&nbsp;&nbsp;&nbsp;
    ï¼ˆå§“åï¼š${safeText(data.signature)}ï¼‰
  </p>

</body>
</html>
      `;

      const blob = new Blob(["\ufeff", htmlContent], {
        type: "application/msword;charset=utf-8"
      });

      let filename = "é¢è©¦è©•åˆ†è¡¨";
      if (data.candidateName) {
        filename += "-" + data.candidateName;
      }
      filename += ".doc";

      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    updateRoleDisplay();
    updateAiToolsVisibility();
    updateErpVisibility();
    updateDiscInfo();
    updatePetVisibility();
  </script>
</body>
</html>
