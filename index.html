<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>面試評分表</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * {
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang TC",
        "Microsoft JhengHei", sans-serif;
    }

    body {
      margin: 0;
      padding: 28px;
      background: radial-gradient(circle at 20% 20%, #eef2ff 0, transparent 25%),
        radial-gradient(circle at 80% 0, #e0f2fe 0, transparent 25%),
        radial-gradient(circle at 10% 80%, #fdf2f8 0, transparent 22%),
        #f5f6fb;
      color: #0f172a;
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      background: #ffffff;
      padding: 28px 28px 36px;
      border-radius: 18px;
      box-shadow: 0 20px 40px rgba(15, 23, 42, 0.16);
      border: 1px solid #e2e8f0;
    }

    h1 {
      text-align: center;
      margin-top: 0;
      margin-bottom: 4px;
      font-size: 26px;
      letter-spacing: 0.06em;
    }

    .subtitle {
      text-align: center;
      font-size: 14px;
      color: #475569;
      margin-bottom: 26px;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 12px 18px;
      margin-bottom: 20px;
    }

    .field {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    label {
      font-size: 13px;
      font-weight: 700;
      color: #1f2937;
    }

    input[type="text"],
    input[type="date"],
    select,
    textarea {
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #d7dce3;
      font-size: 13px;
      transition: border-color 0.15s ease, box-shadow 0.15s ease,
        background-color 0.15s ease;
      background: #f8fafc;
      width: 100%;
    }

    input[type="text"]:focus,
    input[type="date"]:focus,
    select:focus,
    textarea:focus {
      outline: none;
      border-color: #6366f1;
      box-shadow: 0 0 0 3px rgba(129, 140, 248, 0.18);
      background: #ffffff;
    }

    textarea {
      min-height: 120px;
      resize: vertical;
    }

    .section-card {
      border-radius: 16px;
      border: 1px solid #e2e8f0;
      padding: 18px 20px 20px;
      margin-bottom: 18px;
      background: linear-gradient(145deg, #ffffff 0%, #f9fafb 45%, #f8fafc 100%);
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      border-bottom: 1px dashed #e5e7eb;
      padding-bottom: 6px;
      gap: 12px;
      flex-wrap: wrap;
    }

    .section-title {
      font-size: 15px;
      font-weight: 800;
    }

    .section-meta {
      font-size: 12px;
      color: #6b7280;
    }

    .item-row {
      display: grid;
      grid-template-columns: minmax(140px, 160px) 160px 1fr;
      gap: 10px;
      align-items: flex-start;
      padding: 8px 0;
      border-bottom: 1px dashed #f3f4f6;
    }

    .item-row:last-child {
      border-bottom: none;
    }

    .item-label {
      font-size: 13px;
      font-weight: 700;
      color: #374151;
      padding-top: 4px;
    }

    .score-wrapper {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .score-select-row {
      display: flex;
      gap: 6px;
      align-items: center;
      font-size: 12px;
      color: #6b7280;
      flex-wrap: wrap;
    }

    .score-select-row select {
      width: 80px;
    }

    .score-tag {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4f46e5;
      border: 1px solid #e0e7ff;
    }

    .comment-label {
      font-size: 12px;
      color: #6b7280;
    }

    .label-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
    }

    .guideline-toggle {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #c7d2fe;
      background: #eef2ff;
      color: #4338ca;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
    }

    .guideline-section + .guideline-section {
      border-top: 1px dashed #e0e7ff;
      padding-top: 6px;
      margin-top: 6px;
    }

    .guideline-heading {
      font-weight: 700;
      color: #1d4ed8;
    }

    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.35);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 1000;
    }

    .modal-dialog {
      background: #ffffff;
      border-radius: 18px;
      max-width: 520px;
      width: 100%;
      box-shadow: 0 25px 50px rgba(15, 23, 42, 0.25);
      border: 1px solid #e0e7ff;
      animation: fadeIn 0.2s ease;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      padding: 18px 20px 12px;
      border-bottom: 1px solid #f1f5f9;
      gap: 12px;
    }

    .modal-body {
      padding: 16px 20px 22px;
      max-height: 65vh;
      overflow-y: auto;
      font-size: 13px;
      color: #1f2937;
    }

    .modal-eyebrow {
      font-size: 11px;
      letter-spacing: 0.08em;
      color: #6366f1;
      text-transform: uppercase;
      margin-bottom: 2px;
    }

    .modal-title {
      font-size: 18px;
      font-weight: 800;
      margin: 0;
    }

    .modal-close {
      border: none;
      background: #eef2ff;
      color: #4338ca;
      border-radius: 999px;
      width: 34px;
      height: 34px;
      font-size: 18px;
      cursor: pointer;
    }

    .modal-section ul {
      margin: 6px 0 8px 18px;
      padding: 0;
    }

    body.modal-open {
      overflow: hidden;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(12px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .total-row {
      margin-top: 16px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px 16px;
      align-items: center;
      padding: 12px 14px;
      border-radius: 14px;
      background: #f8fafc;
      border: 1px dashed #d7dce3;
    }

    .total-row label {
      margin-right: 4px;
    }

    .total-score {
      font-size: 20px;
      font-weight: 800;
      color: #0f172a;
      min-width: 60px;
      text-align: center;
    }

    .total-hint {
      font-size: 12px;
      color: #6b7280;
    }

    .actions {
      margin-top: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: flex-end;
    }

    button {
      border: none;
      cursor: pointer;
      border-radius: 999px;
      padding: 9px 16px;
      font-size: 13px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.08s ease, box-shadow 0.08s ease,
        background-color 0.15s ease;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, #4f46e5, #6366f1);
      color: #ffffff;
      box-shadow: 0 8px 18px rgba(79, 70, 229, 0.35);
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 10px 22px rgba(79, 70, 229, 0.45);
      background: linear-gradient(135deg, #4338ca, #4f46e5);
    }

    .btn-secondary {
      background: #e5e7eb;
      color: #374151;
    }

    .btn-secondary:hover {
      background: #d1d5db;
      transform: translateY(-1px);
    }

    .btn-ghost {
      background: transparent;
      color: #4338ca;
      border: 1px solid #e0e7ff;
      padding: 8px 14px;
      border-radius: 12px;
    }

    .pill {
      display: inline-flex;
      align-items: center;
      padding: 6px 12px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      font-size: 12px;
      gap: 6px;
    }

    .muted {
      color: #6b7280;
      font-size: 12px;
    }

    .ai-tools-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 8px 10px;
      margin-top: 8px;
    }

    .chip {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 12px;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      font-size: 12px;
      color: #1f2937;
    }

    .hidden {
      display: none;
    }

    .disc-box {
      margin-top: 8px;
      padding: 10px 12px;
      border-radius: 12px;
      border: 1px solid #e2e8f0;
      background: #f8fafc;
      color: #1f2937;
      line-height: 1.5;
    }

    .disc-title {
      font-weight: 700;
      margin-bottom: 4px;
      color: #111827;
    }

    .disc-tag {
      display: inline-block;
      margin-bottom: 6px;
      padding: 2px 8px;
      border-radius: 999px;
      background: #eef2ff;
      color: #4338ca;
      font-size: 12px;
      border: 1px solid #e0e7ff;
    }

    small.helper {
      display: block;
      font-size: 11px;
      color: #9ca3af;
      margin-top: 2px;
    }

    .collapse-toggle {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 8px 12px;
      border-radius: 12px;
      background: #eef2ff;
      color: #4338ca;
      border: 1px solid #e0e7ff;
      font-weight: 700;
    }

    .accordion {
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 12px 14px;
      background: #fbfcff;
      margin-top: 12px;
    }

    .accordion details {
      border-bottom: 1px dashed #e5e7eb;
      padding: 8px 0;
    }

    .accordion details:last-child {
      border-bottom: none;
    }

    .accordion summary {
      cursor: pointer;
      font-weight: 700;
      color: #1f2937;
      outline: none;
    }

    .accordion ul {
      margin: 8px 0 0 18px;
      color: #374151;
      line-height: 1.5;
      font-size: 13px;
    }

    .sub-note {
      color: #6b7280;
      font-size: 12px;
      margin: 8px 0 0 18px;
    }

    .pet-options,
    .radio-row,
    .inline-chips {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
    }

    .tag-pill {
      padding: 6px 10px;
      border-radius: 10px;
      border: 1px solid #e2e8f0;
      background: #f8fafc;
      font-size: 12px;
      color: #1f2937;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .notes-list {
      display: grid;
      gap: 12px;
    }

    .note-card {
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      padding: 12px;
      background: #f9fafb;
    }

    .note-card textarea {
      min-height: 100px;
    }

    .note-toolbar {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 8px;
    }

    .btn-remove-note {
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #fecdd3;
      background: #fff1f2;
      color: #be123c;
      font-size: 11px;
      font-weight: 700;
      cursor: pointer;
    }

    .erp-details {
      margin-top: 8px;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
      padding: 10px 12px;
      background: #f8fafc;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .erp-other-input {
      padding: 8px 10px;
      border-radius: 10px;
      border: 1px solid #d7dce3;
      font-size: 13px;
      background: #ffffff;
    }

    @media (max-width: 960px) {
      .item-row {
        grid-template-columns: 1fr;
      }

      .item-label {
        padding-top: 0;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>面試評分表</h1>
    <div class="subtitle">請依實際面試情況評分與填寫評語，完成後可匯出為 Word 檔。</div>

    <!-- 基本資料 -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">基本資料</div>
        <div class="section-meta">請先確認面試對象與面試官資訊</div>
      </div>
      <div class="grid">
        <div class="field">
          <label for="candidateName">應聘者姓名</label>
          <input type="text" id="candidateName" />
        </div>
        <div class="field">
          <label for="position">面試職位</label>
          <input type="text" id="position" />
        </div>
        <div class="field">
          <label for="interviewDate">面試日期</label>
          <input type="date" id="interviewDate" />
        </div>
        <div class="field">
          <label for="interviewer">面試官姓名</label>
          <input type="text" id="interviewer" />
        </div>
        <div class="field" style="grid-column: 1 / -1;">
          <label for="interviewParticipants">面試參與者</label>
          <textarea
            id="interviewParticipants"
            placeholder="例：人資 Jane、用人主管 Eric、協作夥伴 Kelly"
          ></textarea>
        </div>
      </div>
    </div>

    <!-- 一、基本信息 -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">一、基本信息</div>
        <div class="section-meta">每項滿分 5 分</div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>履歷完整度</span>
            <button type="button" class="guideline-toggle" data-guideline="basic_resume" data-guideline-title="履歷完整度">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–5 分</span>
            <label for="basic_resume_score">評分</label>
            <select id="basic_resume_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option>
            </select>
          </div>
          <small class="helper">履歷是否清楚、完整呈現與職位相關資訊</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="basic_resume_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>教育背景</span>
            <button type="button" class="guideline-toggle" data-guideline="basic_edu" data-guideline-title="教育背景">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–5 分</span>
            <label for="basic_edu_score">評分</label>
            <select id="basic_edu_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option>
            </select>
          </div>
          <small class="helper">學歷是否符合職位需求，專業相關性</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="basic_edu_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>工作經歷</span>
            <button type="button" class="guideline-toggle" data-guideline="basic_exp" data-guideline-title="工作經歷">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–5 分</span>
            <label for="basic_exp_score">評分</label>
            <select id="basic_exp_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option>
            </select>
          </div>
          <small class="helper">過往經歷與職務內容之匹配程度</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="basic_exp_comment"></textarea>
        </div>
      </div>
    </div>

    <!-- 二、專業能力 -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">二、專業能力</div>
        <div class="section-meta">每項滿分 10 分</div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>技術技能</span>
            <button type="button" class="guideline-toggle" data-guideline="pro_tech" data-guideline-title="技術技能">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–10 分</span>
            <label for="pro_tech_score">評分</label>
            <select id="pro_tech_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option><option>6</option>
              <option>7</option><option>8</option><option>9</option>
              <option>10</option>
            </select>
          </div>
          <small class="helper">專業技能熟練度、工具與系統使用能力</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="pro_tech_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>問題解決能力</span>
            <button type="button" class="guideline-toggle" data-guideline="pro_problem" data-guideline-title="問題解決能力">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–10 分</span>
            <label for="pro_problem_score">評分</label>
            <select id="pro_problem_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option><option>6</option>
              <option>7</option><option>8</option><option>9</option>
              <option>10</option>
            </select>
          </div>
          <small class="helper">分析與解決問題、落實方案與驗證效果</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="pro_problem_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>學習能力</span>
            <button type="button" class="guideline-toggle" data-guideline="pro_learning" data-guideline-title="學習能力">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–10 分</span>
            <label for="pro_learning_score">評分</label>
            <select id="pro_learning_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option><option>6</option>
              <option>7</option><option>8</option><option>9</option>
              <option>10</option>
            </select>
          </div>
          <small class="helper">學習新知與自我精進的意願與方法</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="pro_learning_comment"></textarea>
        </div>
      </div>
    </div>

    <!-- 三、軟技能 -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">三、軟技能</div>
        <div class="section-meta">每項滿分 10 分</div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>溝通能力</span>
            <button type="button" class="guideline-toggle" data-guideline="soft_comm" data-guideline-title="溝通能力">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–10 分</span>
            <label for="soft_comm_score">評分</label>
            <select id="soft_comm_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option><option>6</option>
              <option>7</option><option>8</option><option>9</option>
              <option>10</option>
            </select>
          </div>
          <small class="helper">資訊表達、傾聽與向上溝通的效率</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="soft_comm_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>團隊合作</span>
            <button type="button" class="guideline-toggle" data-guideline="soft_team" data-guideline-title="團隊合作">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–10 分</span>
            <label for="soft_team_score">評分</label>
            <select id="soft_team_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option><option>6</option>
              <option>7</option><option>8</option><option>9</option>
              <option>10</option>
            </select>
          </div>
          <small class="helper">團隊分工協作、支援同仁與協調能力</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="soft_team_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>時間管理</span>
            <button type="button" class="guideline-toggle" data-guideline="soft_time" data-guideline-title="時間管理">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–10 分</span>
            <label for="soft_time_score">評分</label>
            <select id="soft_time_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option><option>6</option>
              <option>7</option><option>8</option><option>9</option>
              <option>10</option>
            </select>
          </div>
          <small class="helper">排程能力、優先順序判斷與交付準時度</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="soft_time_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>抗壓能力</span>
            <button type="button" class="guideline-toggle" data-guideline="soft_stress" data-guideline-title="抗壓能力">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–10 分</span>
            <label for="soft_stress_score">評分</label>
            <select id="soft_stress_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option><option>6</option>
              <option>7</option><option>8</option><option>9</option>
              <option>10</option>
            </select>
          </div>
          <small class="helper">面對壓力時的穩定度與調適方法</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="soft_stress_comment"></textarea>
        </div>
      </div>
    </div>

    <!-- 四、面試表現 -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">四、面試表現</div>
        <div class="section-meta">每項滿分 5 分</div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>應對能力</span>
            <button type="button" class="guideline-toggle" data-guideline="perf_response" data-guideline-title="應對能力">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–5 分</span>
            <label for="perf_response_score">評分</label>
            <select id="perf_response_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option>
            </select>
          </div>
          <small class="helper">臨場反應、聚焦重點的能力</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="perf_response_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>職業態度</span>
            <button type="button" class="guideline-toggle" data-guideline="perf_attitude" data-guideline-title="職業態度">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–5 分</span>
            <label for="perf_attitude_score">評分</label>
            <select id="perf_attitude_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option>
            </select>
          </div>
          <small class="helper">責任感、穩定度與對工作的認真程度</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="perf_attitude_comment"></textarea>
        </div>
      </div>

      <div class="item-row">
        <div class="item-label">
          <div class="label-top">
            <span>儀表儀態</span>
            <button type="button" class="guideline-toggle" data-guideline="perf_manner" data-guideline-title="儀表儀態">展開提問</button>
          </div>
        </div>
        <div class="score-wrapper">
          <div class="score-select-row">
            <span class="score-tag">1–5 分</span>
            <label for="perf_manner_score">評分</label>
            <select id="perf_manner_score" class="score-input" data-field>
              <option value="">—</option>
              <option>1</option><option>2</option><option>3</option>
              <option>4</option><option>5</option>
            </select>
          </div>
          <small class="helper">穿著、禮貌與專業形象</small>
        </div>
        <div>
          <div class="comment-label">評語</div>
          <textarea id="perf_manner_comment"></textarea>
        </div>
      </div>
    </div>

    <!-- 總評 -->
    <div class="section-card">
      <div class="total-row">
        <div style="display:flex;align-items:center;gap:6px;">
          <label>總分(滿分 100 分)：</label>
          <div class="total-score" id="totalScore">—</div>
        </div>
        <div class="total-hint">
          系統會自動加總所有評分。若有未填寫的項目，總分會略低於 100 分。
        </div>
      </div>

      <div style="margin-top:12px;">
        <div class="field">
          <label for="overall_comment">總評 — 綜合評價及建議</label>
          <textarea id="overall_comment" placeholder="例如：整體專業能力佳，建議錄用／可列入備選名單／暫不適合該職位等。"></textarea>
        </div>
      </div>

      <div style="margin-top:12px;" class="grid">
        <div class="field">
          <label for="signature">面試官簽名（可輸入姓名，Word 中可再手簽）：</label>
          <input type="text" id="signature" />
        </div>
      </div>
    </div>

    <!-- 補充資訊與提問 -->
    <div class="section-card">
      <div class="section-header">
        <div class="section-title">候選人自述與補充資訊</div>
        <div class="section-meta">放在最後，方便整理面談後的補充紀錄</div>
      </div>

      <div class="field">
        <label for="achievement_note">工作上最有成就感的事情與經驗</label>
        <textarea
          id="achievement_note"
          placeholder="請記錄具體案例、面試官觀察與後續可追問的重點"
        ></textarea>
      </div>
      <div class="field">
        <label for="challenge_note">工作上遇到最大的挫折及解決方法</label>
        <textarea
          id="challenge_note"
          placeholder="請紀錄情境、候選人應對方式以及學到的經驗"
        ></textarea>
      </div>

      <div class="grid">
        <div class="field">
          <label for="strength_primary">候選人自述的優點 #1</label>
          <small class="helper">第一個通常是面試者準備好的標準答案，可紀錄面試官觀察與提醒。</small>
          <textarea id="strength_primary" placeholder="例：擅長跨部門溝通／非常熟悉流程等"></textarea>
        </div>
        <div class="field">
          <label for="strength_secondary">候選人自述的優點 #2</label>
          <small class="helper">第二個多半較貼近真實想法，可補充其實際例子或可信度。</small>
          <textarea id="strength_secondary" placeholder="例：有耐心處理客戶、喜歡自主學習等"></textarea>
        </div>
      </div>

      <div class="grid">
        <div class="field">
          <label for="weakness_primary">候選人自述的缺點 #1</label>
          <small class="helper">第一個常見於網路整理的「模範答案」，可註記其真實性。</small>
          <textarea id="weakness_primary" placeholder="例：需要加強簡報能力、希望提升數據力等"></textarea>
        </div>
        <div class="field">
          <label for="weakness_secondary">候選人自述的缺點 #2</label>
          <small class="helper">通常較貼近真實狀態，可記錄需追蹤或培訓的方向。</small>
          <textarea id="weakness_secondary" placeholder="例：對陌生領域較沒自信、需要提醒細節等"></textarea>
        </div>
      </div>

      <div class="grid">
        <div class="field">
          <label>是否有使用 AI 軟體？</label>
          <div class="score-select-row" style="gap:10px;">
            <label class="chip"><input type="radio" name="ai_usage" value="yes" /> 有</label>
            <label class="chip"><input type="radio" name="ai_usage" value="no" /> 沒有</label>
            <span class="muted">若勾選「有」，可勾選常用工具</span>
          </div>
          <div id="aiToolsWrapper" class="ai-tools-grid hidden">
            <label class="chip"><input type="checkbox" class="ai-tool" value="ChatGPT" /> ChatGPT</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Adobe" /> Adobe</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Canva" /> Canva</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Gemini" /> Gemini</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Notion AI" /> Notion AI</label>
            <label class="chip"><input type="checkbox" class="ai-tool" value="Microsoft Copilot" /> Microsoft Copilot</label>
            <div class="field" style="grid-column: 1 / -1; margin-top:4px;">
              <label for="ai_other" class="muted">其他常用 AI（可輸入）</label>
              <input type="text" id="ai_other" placeholder="請填寫其他工具名稱或使用情境" />
            </div>
          </div>
        </div>

        <div class="field">
          <label>ERP 使用經驗？</label>
          <div class="radio-row">
            <label class="chip"><input type="radio" name="erp_experience" value="yes" /> 有</label>
            <label class="chip"><input type="radio" name="erp_experience" value="no" /> 沒有</label>
          </div>
          <small class="helper">若勾選「有」，可記錄是否使用過鼎新 ERP 或其他系統。</small>
          <div id="erpDetails" class="erp-details hidden">
            <div class="muted">使用過的 ERP 系統（可複選）</div>
            <div class="inline-chips">
              <label class="chip"><input type="checkbox" class="erp-option" value="鼎新 ERP" /> 鼎新 ERP</label>
              <label class="chip"><input type="checkbox" id="erp_other_checkbox" class="erp-option" value="其他" data-other="true" /> 其他，請填寫</label>
            </div>
            <input type="text" id="erp_other" class="hidden erp-other-input" placeholder="例如：SAP、Oracle、NetSuite 等" />
          </div>
        </div>

        <div class="field">
          <label for="disc_type">DISC 人格測驗結果</label>
          <select id="disc_type">
            <option value="">— 請選擇 —</option>
            <option value="D">支配型（D）- 老虎</option>
            <option value="I">影響型（I）- 孔雀</option>
            <option value="S">穩健型（S）- 無尾熊</option>
            <option value="C">謹慎型（C）- 貓頭鷹</option>
          </select>
          <div id="discResult" class="disc-box">
            <div class="disc-title">尚未選擇</div>
            <div class="muted">選擇 DISC 類型後，系統會自動帶出人格特質與適合的職場情境，方便記錄在 Word。</div>
          </div>
        </div>
      </div>

      <div class="section-header" style="padding-top:8px;">
        <div class="section-title">補充資料</div>
        <div class="section-meta">寵物照護與備註</div>
      </div>
      <div class="grid">
        <div class="field">
          <label>是否有養寵物？</label>
          <div class="pet-options">
            <label class="tag-pill"><input type="radio" name="pet_status" value="yes" /> 有</label>
            <label class="tag-pill"><input type="radio" name="pet_status" value="no" /> 沒有</label>
            <label class="tag-pill"><input type="radio" name="pet_status" value="past" /> 以前養過</label>
          </div>
          <small class="helper">選「有」或「以前養過」時，請勾選類型並填寫照護資訊。</small>
        </div>
        <div class="field hidden" id="petTypesWrapper">
          <label>寵物類型（可複選）</label>
          <div class="inline-chips" id="petTypes">
            <label class="chip"><input type="checkbox" value="狗" /> 狗</label>
            <label class="chip"><input type="checkbox" value="貓" /> 貓</label>
            <label class="chip"><input type="checkbox" value="非犬貓" /> 非犬貓</label>
          </div>
        </div>
      </div>
      <div class="field hidden" id="petFeederWrapper">
        <label>是否為飼料挑選者？</label>
        <div class="radio-row">
          <label class="chip"><input type="radio" name="pet_feeder" value="yes" /> 是</label>
          <label class="chip"><input type="radio" name="pet_feeder" value="no" /> 否</label>
        </div>
      </div>
      <div class="field">
        <label for="pet_note">寵物相關備註</label>
        <textarea id="pet_note" placeholder="填寫飼養經驗、照護時間安排、食物挑選考量等"></textarea>
      </div>

      <div class="section-header" style="padding-top:8px;">
        <div class="section-title">面試者提問</div>
        <div class="section-meta">可持續新增，讓面試官記錄回答與想法</div>
        <button type="button" class="btn-ghost" id="addQuestion">＋ 新增提問</button>
      </div>
      <div class="notes-list" id="questionList"></div>
    </div>

    <!-- 操作按鈕 -->
  <div class="actions">
    <button type="button" class="btn-secondary" onclick="resetForm()">
      重置表單
    </button>
    <button type="button" class="btn-primary" onclick="exportToWord()">
      匯出為 Word
    </button>
  </div>
</div>

  <div id="guidelineModal" class="modal-backdrop hidden">
    <div class="modal-dialog">
      <div class="modal-header">
        <div>
          <div class="modal-eyebrow">提問小抄</div>
          <div id="guidelineModalTitle" class="modal-title">面試提問建議</div>
        </div>
        <button type="button" class="modal-close" data-close-modal>&times;</button>
      </div>
      <div class="modal-body">
        <div class="guideline-section">
          <div class="guideline-heading">可以問：</div>
          <ul id="guidelineModalQuestions"></ul>
        </div>
        <div class="guideline-section">
          <div class="guideline-heading">面試官參考：</div>
          <ul id="guidelineModalNotes"></ul>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 自動計算總分
    const scoreInputs = document.querySelectorAll(".score-input");
    const totalScoreEl = document.getElementById("totalScore");
    const aiUsageInputs = document.querySelectorAll("input[name='ai_usage']");
    const aiToolsWrapper = document.getElementById("aiToolsWrapper");
    const aiToolCheckboxes = document.querySelectorAll(".ai-tool");
    const aiOtherInput = document.getElementById("ai_other");
    const discSelect = document.getElementById("disc_type");
    const discResult = document.getElementById("discResult");
    const petStatusInputs = document.querySelectorAll("input[name='pet_status']");
    const petTypesWrapper = document.getElementById("petTypesWrapper");
    const petFeederWrapper = document.getElementById("petFeederWrapper");
    const questionList = document.getElementById("questionList");
    const addQuestionBtn = document.getElementById("addQuestion");
    const erpExperienceRadios = document.querySelectorAll("input[name='erp_experience']");
    const erpDetails = document.getElementById("erpDetails");
    const erpOtherCheckbox = document.getElementById("erp_other_checkbox");
    const erpOtherInput = document.getElementById("erp_other");
    const erpOptions = document.querySelectorAll(".erp-option");
    const guidelineToggles = document.querySelectorAll(".guideline-toggle");
    const guidelineModal = document.getElementById("guidelineModal");
    const guidelineModalTitle = document.getElementById("guidelineModalTitle");
    const guidelineModalQuestions = document.getElementById("guidelineModalQuestions");
    const guidelineModalNotes = document.getElementById("guidelineModalNotes");
    const guidelineModalCloseButtons = document.querySelectorAll("[data-close-modal]");

    const guidelineData = {
      basic_resume: {
        questions: [
          "「你可不可以用 2～3 分鐘簡單介紹一下你的背景？從最近的經歷開始說就好。」",
          "「你送給我們的履歷裡，有哪個部分是你覺得最能代表你自己、最希望我們看到的？」",
          "「我看到你在 XX 年到 XX 年之間沒有工作紀錄，那段時間主要在做些什麼呢？」"
        ],
        notes: [
          "他說的內容跟履歷是不是一致？（不一致要小心）",
          "描述是否條理清楚、有邏輯。",
          "是否有誠實面對空白期、轉職原因。"
        ]
      },
      basic_edu: {
        questions: [
          "「當初為什麼會選擇這個科系？跟你現在求職的職位，你覺得有什麼連結？」",
          "「在求學期間，有沒有哪一門課程、專題或報告，讓你印象特別深刻？你在裡面的角色是什麼？」",
          "「如果用一個例子說明，你覺得在學校裡學到、現在工作也用得上的東西是什麼？」"
        ],
        notes: [
          "專業是否和職務有關（尤其是會計、品保、研發等技術性職位）。",
          "是否能從學校經驗中整理出可轉換到職場的能力。",
          "描述是否具體、有例子，而不是講一堆空話。"
        ]
      },
      basic_exp: {
        questions: [
          "「在上一份工作裡，你覺得最有成就感的一件事是什麼？你具體做了哪些事情？」",
          "「你離開上一份工作的主要原因是什麼？」",
          "「如果用一個例子分享，你覺得之前的工作經驗，對這份職缺最有幫助的是哪一塊？」"
        ],
        notes: [
          "是否真的做過履歷上寫的事情（細節一問就知道）。",
          "是否常換工作、每次離職原因是不是合理。",
          "他的角色是「主導」還是只是「執行別人交代」。"
        ]
      },
      pro_tech: {
        questions: [
          "「如果以 1～10 分來看，你會給自己在 XX 技能（例如 Excel、品質檢驗、機台操作）幾分？為什麼？」",
          "「你最近一次用到這個技能，是在做什麼任務？方便舉一個具體例子嗎？」",
          "「實務上遇到不熟悉的工具或系統，你通常怎麼快速上手？」"
        ],
        notes: [
          "他給自己的分數是否合理（可以追問：那 VLOOKUP／樞紐分析你會嗎？等）。",
          "有沒有實際案例，而不是只說「我很熟」。",
          "若是技術職，可以考慮情境題或當場操作／筆試。"
        ]
      },
      pro_problem: {
        questions: [
          "「過去工作裡，有沒有遇過一個比較棘手的問題？你當時怎麼發現、怎麼處理？結果如何？」",
          "「曾經有沒有犯過錯？你怎麼發現問題、怎麼補救？後來有沒有做什麼避免再發生？」",
          "「遇到客訴／生產異常／文件出錯（依職務換例子），你覺得處理的優先順序會是什麼？為什麼？」"
        ],
        notes: [
          "他是不是只是在抱怨別人，還是會自我反省、找方法。",
          "描述的步驟有沒有邏輯（先確認問題 → 找原因 → 提方案 → 檢討）。",
          "有沒有真正落到行動與結果，而不是只說「我會跟同事討論」。"
        ]
      },
      pro_learning: {
        questions: [
          "「最近一年，你主動學習或自我進修的內容有哪些？可以舉一個最具體的例子？」",
          "「遇到不會的工作內容，通常你第一步會怎麼做？上網查？問同事？還是自己摸索？」",
          "「有沒有哪一次，你一開始完全不懂，但後來真的學會並能獨立完成？那個過程是怎樣？」"
        ],
        notes: [
          "有沒有具體學習行為（看書、線上課程、問前輩、自己試）。",
          "是被動等人教，還是會主動找資料。",
          "對「不會」這件事的態度，是逃避還是願意面對。"
        ]
      },
      soft_comm: {
        questions: [
          "「你曾經需要把一件複雜的事情，說明給不是該領域的人聽嗎？你當時怎麼講？」",
          "「過去有沒有跟同事或主管在溝通上產生誤會？後來是怎麼處理和化解？」",
          "「如果你覺得主管的指令不太合理，你會怎麼處理？」"
        ],
        notes: [
          "他在描述時是不是有條理、會不會一直繞圈子。",
          "面對衝突，是溝通、冷處理，還是硬碰硬。",
          "對向上溝通的態度（敢不敢提意見，有沒有方法）。"
        ]
      },
      soft_team: {
        questions: [
          "「分享一個你和團隊一起完成的專案／任務，你在其中扮演什麼角色？」",
          "「如果團隊裡有人進度落後，影響整體時程，你會怎麼做？」",
          "「你認為你的管理風格偏向如何？」"
        ],
        notes: [
          "會不會只強調「我、我、我」，完全忽略團隊。",
          "是否願意支援他人、協調，而不是只會抱怨。",
          "是否能區分職責跟情緒，不把情緒當主角。"
        ]
      },
      soft_time: {
        questions: [
          "「你一天的工作通常怎麼安排？有沒有自己的一套方法？」",
          "「當同時有三件事情都很急，你會怎麼排優先順序？」",
          "「有沒有過交不出來、delay 的情況？那次發生什麼事？你後來怎麼避免再發生？」"
        ],
        notes: [
          "有沒有自己管理待辦事項的方法（筆記本、系統、Excel…）。",
          "面對急件時會不會慌亂，還是知道先處理什麼。",
          "對延誤是否誠實、會不會檢討自己。"
        ]
      },
      soft_stress: {
        questions: [
          "「你在過去工作中壓力最大的一段時間是什麼狀況？當時壓力來源是什麼？怎麼撐過去的？」",
          "「如果主管臨時在下班前丟一個緊急任務給你，你會怎麼處理？」",
          "「你平常有沒有自己的紓壓方式？例如運動、興趣等等？」"
        ],
        notes: [
          "壓力大的例子是否真實，而不是講很平淡的小事。",
          "面對壓力時，是崩潰、逃避，還是會尋求資源／排優先順序。",
          "有沒有建立個人調適方式（不是一定要很厲害，但要有自覺）。"
        ]
      },
      perf_response: {
        questions: [
          "「如果今天你進公司後，主管臨時把你調去支援另外一個部門，你會怎麼看待這件事？」",
          "「假設某個流程突然出問題，大家都在問怎麼辦，你會先做什麼？」",
          "「如果客戶／內部同仁情緒比較激動，你會怎麼應對？」"
        ],
        notes: [
          "回答是不是能快速抓到重點，而不是答非所問。",
          "面對假設情境是否能有具體做法。",
          "面試過程中，臨時改變問題，他會不會慌掉。"
        ]
      },
      perf_attitude: {
        questions: [
          "「你理想中的好工作環境是什麼樣子？有哪些元素是你很在意的？」",
          "「遇到你不喜歡但必須完成的工作，你會怎麼調整心態？」"
        ],
        notes: [
          "是否只想準時上下班、不要麻煩，還是能接受合理的彈性。",
          "對雜事、小事的態度，是抗拒還是願意扛。",
          "對公司、產業有沒有基本尊重與興趣。"
        ]
      },
      perf_manner: {
        questions: [
          "「今天知道要來面試，我看你準備得滿整齊的，你是怎麼看待『專業形象』這件事？」",
          "「你覺得在辦公室裡，什麼樣的禮貌或基本規範是很重要的？」"
        ],
        notes: [
          "服裝是否符合公司文化（不用一定西裝，但至少乾淨、得體）。",
          "語氣、眼神、坐姿是否尊重、專注。",
          "進出會議室是否會敲門、說謝謝等基本禮儀。"
        ]
      }
    };

    const discDescriptions = {
      D: {
        title: "支配型（D）- 老虎",
        traits:
          "目標導向、行動迅速、有決斷力，喜歡挑戰並勇於承擔風險。",
        jobs:
          "領導者、管理者、危機處理、專案推動、需要達成目標的銷售或開發職位。"
      },
      I: {
        title: "影響型（I）- 孔雀",
        traits:
          "熱情有活力、善於溝通、能激勵他人，樂於在團隊中互動。",
        jobs:
          "業務、行銷、公關、人資、需要大量人際互動與協作的職位。"
      },
      S: {
        title: "穩健型（S）- 無尾熊",
        traits:
          "冷靜溫和、處事圓融、忠誠可信賴，偏好穩定可預測的工作步調。",
        jobs:
          "客戶服務、教育、行政、團隊合作型的專案支援，或是在領導帶領下執行任務。"
      },
      C: {
        title: "謹慎型（C）- 貓頭鷹",
        traits:
          "邏輯性強、分析力佳、細心謹慎，重視規則與細節。",
        jobs:
          "財務、會計、專案管理、研究員、品管等需要精確性和分析力的工作。"
      }
    };

    function renderGuidelineList(target, items) {
      if (!target) return;
      if (!items || !items.length) {
        target.innerHTML = "<li>—</li>";
        return;
      }
      target.innerHTML = items.map((text) => `<li>${text}</li>`).join("");
    }

    function openGuidelineModal(key, label) {
      if (!guidelineModal) return;
      const info = guidelineData[key];
      if (!info) return;
      guidelineModalTitle.textContent = label || "面試提問建議";
      renderGuidelineList(guidelineModalQuestions, info.questions);
      renderGuidelineList(guidelineModalNotes, info.notes);
      guidelineModal.classList.remove("hidden");
      document.body.classList.add("modal-open");
    }

    function closeGuidelineModal() {
      if (!guidelineModal) return;
      guidelineModal.classList.add("hidden");
      document.body.classList.remove("modal-open");
    }

    guidelineToggles.forEach((btn) => {
      btn.addEventListener("click", () => {
        openGuidelineModal(btn.dataset.guideline, btn.dataset.guidelineTitle);
      });
    });

    guidelineModalCloseButtons.forEach((btn) =>
      btn.addEventListener("click", closeGuidelineModal)
    );

    if (guidelineModal) {
      guidelineModal.addEventListener("click", (event) => {
        if (event.target === guidelineModal) {
          closeGuidelineModal();
        }
      });
    }

    function updateTotalScore() {
      let total = 0;
      scoreInputs.forEach((sel) => {
        const val = parseInt(sel.value, 10);
        if (!isNaN(val)) total += val;
      });
      totalScoreEl.textContent = total > 0 ? total : "—";
    }

    scoreInputs.forEach((sel) => {
      sel.addEventListener("change", updateTotalScore);
    });

    function updateAiToolsVisibility() {
      const usingAi =
        (document.querySelector("input[name='ai_usage']:checked") || {})
          .value === "yes";
      aiToolsWrapper.classList.toggle("hidden", !usingAi);
      if (!usingAi) {
        aiToolCheckboxes.forEach((cb) => (cb.checked = false));
        aiOtherInput.value = "";
      }
      return usingAi;
    }

    aiUsageInputs.forEach((input) =>
      input.addEventListener("change", updateAiToolsVisibility)
    );

    function updateErpOtherInput() {
      if (!erpOtherInput) return;
      const shouldShow = erpOtherCheckbox && erpOtherCheckbox.checked;
      erpOtherInput.classList.toggle("hidden", !shouldShow);
      if (!shouldShow) {
        erpOtherInput.value = "";
      }
    }

    function updateErpVisibility() {
      const hasExperience = Array.from(erpExperienceRadios).some(
        (radio) => radio.checked && radio.value === "yes"
      );
      if (erpDetails) {
        erpDetails.classList.toggle("hidden", !hasExperience);
      }
      if (!hasExperience) {
        erpOptions.forEach((cb) => (cb.checked = false));
        if (erpOtherInput) erpOtherInput.value = "";
      }
      updateErpOtherInput();
      return hasExperience;
    }

    erpExperienceRadios.forEach((radio) =>
      radio.addEventListener("change", updateErpVisibility)
    );

    if (erpOtherCheckbox) {
      erpOtherCheckbox.addEventListener("change", updateErpOtherInput);
    }

    function getSelectedAiTools() {
      const tools = Array.from(aiToolCheckboxes)
        .filter((cb) => cb.checked)
        .map((cb) => cb.value);
      if (aiOtherInput.value.trim()) tools.push(aiOtherInput.value.trim());
      return tools;
    }

    function updateDiscInfo() {
      const type = discSelect.value;
      const info = discDescriptions[type];
      if (!info) {
        discResult.innerHTML =
          '<div class="disc-title">尚未選擇</div><div class="muted">選擇 DISC 類型後，系統會自動帶出人格特質與適合的職場情境，方便記錄在 Word。</div>';
        return;
      }

      discResult.innerHTML = `
        <div class="disc-tag">${info.title}</div>
        <div class="disc-title">人格特質</div>
        <div>${info.traits}</div>
        <div class="disc-title" style="margin-top:6px;">適合的職場情境</div>
        <div>${info.jobs}</div>
      `;
    }

    discSelect.addEventListener("change", updateDiscInfo);

    function updatePetVisibility() {
      const status = (document.querySelector("input[name='pet_status']:checked") || {})
        .value;
      const shouldShow = status === "yes" || status === "past";
      if (petTypesWrapper) {
        petTypesWrapper.classList.toggle("hidden", !shouldShow);
      }
      if (petFeederWrapper) {
        petFeederWrapper.classList.toggle("hidden", !shouldShow);
      }
      if (!shouldShow) {
        document
          .querySelectorAll("#petTypes input[type='checkbox']")
          .forEach((cb) => (cb.checked = false));
        document
          .querySelectorAll("input[name='pet_feeder']")
          .forEach((r) => (r.checked = false));
      }
    }

    petStatusInputs.forEach((input) =>
      input.addEventListener("change", updatePetVisibility)
    );

    function addQuestionNote(initialValue = "") {
      const note = document.createElement("div");
      note.className = "note-card";
      const toolbar = document.createElement("div");
      toolbar.className = "note-toolbar";
      const removeBtn = document.createElement("button");
      removeBtn.type = "button";
      removeBtn.className = "btn-remove-note";
      removeBtn.textContent = "刪除此提問";
      removeBtn.addEventListener("click", () => {
        note.remove();
        if (!questionList.children.length) {
          addQuestionNote();
        }
      });
      toolbar.appendChild(removeBtn);
      const textarea = document.createElement("textarea");
      textarea.placeholder = "輸入提問內容與面試官筆記";
      textarea.value = initialValue;
      note.appendChild(toolbar);
      note.appendChild(textarea);
      questionList.appendChild(note);
    }

    addQuestionBtn.addEventListener("click", () => addQuestionNote());
    addQuestionNote();

    function resetForm() {
      if (!confirm("確定要清空整份評分表嗎？")) return;
      document.querySelectorAll("input, textarea, select").forEach((el) => {
        if (el.type === "radio" || el.type === "checkbox") {
          el.checked = false;
        } else {
          el.value = "";
        }
      });
      updateTotalScore();
      updateAiToolsVisibility();
      updateErpVisibility();
      updateDiscInfo();
      updatePetVisibility();
      closeGuidelineModal();
      questionList.innerHTML = "";
      addQuestionNote();
    }

    function safeText(text) {
      if (!text) return "";
      return text.replace(/&/g, "&amp;")
                 .replace(/</g, "&lt;")
                 .replace(/>/g, "&gt;")
                 .replace(/"/g, "&quot;");
    }

    function formatMultiline(text) {
      return safeText(text || "").replace(/\n/g, "<br>");
    }

    function getInterviewQuestions() {
      return Array.from(questionList.querySelectorAll("textarea"))
        .map((ta) => ta.value.trim())
        .filter((v) => v);
    }

    function getPetTypes() {
      return Array.from(
        document.querySelectorAll("#petTypes input[type='checkbox']")
      )
        .filter((cb) => cb.checked)
        .map((cb) => cb.value);
    }

    function getErpSelections() {
      const selections = [];
      erpOptions.forEach((cb) => {
        if (!cb.checked) return;
        if (cb.dataset.other) {
          const otherValue = (erpOtherInput.value || "").trim();
          selections.push(otherValue || "其他（未填）");
        } else {
          selections.push(cb.value);
        }
      });
      return selections;
    }

    function exportToWord() {
      updateTotalScore();

      const data = {
        candidateName: document.getElementById("candidateName").value || "",
        position: document.getElementById("position").value || "",
        interviewDate: document.getElementById("interviewDate").value || "",
        interviewer: document.getElementById("interviewer").value || "",
        interviewParticipants:
          document.getElementById("interviewParticipants").value || "",
        achievement_note: document.getElementById("achievement_note").value,
        challenge_note: document.getElementById("challenge_note").value,
        strength_primary: document.getElementById("strength_primary").value,
        strength_secondary: document.getElementById("strength_secondary").value,
        weakness_primary: document.getElementById("weakness_primary").value,
        weakness_secondary: document.getElementById("weakness_secondary").value,
        ai_usage:
          (document.querySelector("input[name='ai_usage']:checked") || {})
            .value || "",
        ai_tools: getSelectedAiTools(),
        ai_other: aiOtherInput.value,
        erp_experience:
          (document.querySelector("input[name='erp_experience']:checked") || {})
            .value || "",
        erp_systems: getErpSelections(),
        erp_other: erpOtherInput.value,
        disc_type: discSelect.value,
        // 基本信息
        basic_resume_score: document.getElementById("basic_resume_score").value,
        basic_resume_comment: document.getElementById("basic_resume_comment").value,
        basic_edu_score: document.getElementById("basic_edu_score").value,
        basic_edu_comment: document.getElementById("basic_edu_comment").value,
        basic_exp_score: document.getElementById("basic_exp_score").value,
        basic_exp_comment: document.getElementById("basic_exp_comment").value,
        // 專業能力
        pro_tech_score: document.getElementById("pro_tech_score").value,
        pro_tech_comment: document.getElementById("pro_tech_comment").value,
        pro_problem_score: document.getElementById("pro_problem_score").value,
        pro_problem_comment: document.getElementById("pro_problem_comment").value,
        pro_learning_score: document.getElementById("pro_learning_score").value,
        pro_learning_comment: document.getElementById("pro_learning_comment").value,
        // 軟技能
        soft_comm_score: document.getElementById("soft_comm_score").value,
        soft_comm_comment: document.getElementById("soft_comm_comment").value,
        soft_team_score: document.getElementById("soft_team_score").value,
        soft_team_comment: document.getElementById("soft_team_comment").value,
        soft_time_score: document.getElementById("soft_time_score").value,
        soft_time_comment: document.getElementById("soft_time_comment").value,
        soft_stress_score: document.getElementById("soft_stress_score").value,
        soft_stress_comment: document.getElementById("soft_stress_comment").value,
        // 面試表現
        perf_response_score: document.getElementById("perf_response_score").value,
        perf_response_comment: document.getElementById("perf_response_comment").value,
        perf_attitude_score: document.getElementById("perf_attitude_score").value,
        perf_attitude_comment: document.getElementById("perf_attitude_comment").value,
        perf_manner_score: document.getElementById("perf_manner_score").value,
        perf_manner_comment: document.getElementById("perf_manner_comment").value,
        // 總評
        overall_comment: document.getElementById("overall_comment").value,
        signature: document.getElementById("signature").value,
        totalScore: totalScoreEl.textContent,
        // 補充資料
        pet_status:
          (document.querySelector("input[name='pet_status']:checked") || {})
            .value || "",
        pet_types: getPetTypes(),
        pet_feeder:
          (document.querySelector("input[name='pet_feeder']:checked") || {})
            .value || "",
        pet_note: document.getElementById("pet_note").value,
        interview_questions: getInterviewQuestions()
      };

      const aiToolsText = data.ai_usage === "yes" ? data.ai_tools.join("、") : "未使用";
      const erpStatusMap = {
        yes: "有",
        no: "沒有"
      };
      const erpStatusText = erpStatusMap[data.erp_experience] || "未填寫";
      const erpSystemsText =
        data.erp_experience === "yes"
          ? data.erp_systems.length
            ? data.erp_systems.join("、")
            : "未填寫"
          : "—";

      const petStatusMap = {
        yes: "有",
        no: "沒有",
        past: "以前養過"
      };

      const petStatusText = petStatusMap[data.pet_status] || "未填寫";
      const petTypesText = data.pet_types.length
        ? data.pet_types.join("、")
        : "—";
      const petFeederText = data.pet_feeder === "yes" ? "是" : data.pet_feeder === "no" ? "否" : "未填寫";
      const questionListHtml = data.interview_questions.length
        ? `<ul>${data.interview_questions
            .map((q) => `<li>${formatMultiline(q)}</li>`)
            .join("")}</ul>`
        : "<div class=\"muted\">未填寫</div>";

      const htmlContent = `
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
  body { font-family: "Microsoft JhengHei", Arial, sans-serif; line-height: 1.6; color: #111827; }
  h2 { margin-top: 24px; margin-bottom: 8px; }
  table { width: 100%; border-collapse: collapse; margin-bottom: 16px; }
  th, td { padding: 8px 10px; text-align: left; }
  .border { border: 1px solid #d1d5db; }
  .score-cell { width: 80px; text-align: center; }
  .box-line { border-top: 1px solid #e5e7eb; margin: 12px 0; }
  .section-title { font-size: 16px; font-weight: 700; margin: 14px 0 6px; }
  .muted { color: #6b7280; }
  .signature-line { margin-top: 26px; }
</style>
</head>
<body>
  <h2>面試評分表</h2>
  <p><strong>應聘者姓名：</strong> ${safeText(data.candidateName)}<br>
     <strong>面試職位：</strong> ${safeText(data.position)}<br>
     <strong>面試日期：</strong> ${safeText(data.interviewDate)}<br>
     <strong>面試官：</strong> ${safeText(data.interviewer)}<br>
     <strong>面試參與者：</strong> ${formatMultiline(data.interviewParticipants || "未填寫")}</p>

  <div class="section-title">一、基本信息（每項滿分 5 分）</div>
  <table>
    <tr>
      <th class="border">項目</th>
      <th class="border">評分</th>
      <th class="border">評語</th>
    </tr>
    <tr>
      <td class="border">履歷完整度</td>
      <td class="border score-cell">${safeText(data.basic_resume_score)}</td>
      <td class="border">${formatMultiline(data.basic_resume_comment)}</td>
    </tr>
    <tr>
      <td class="border">教育背景</td>
      <td class="border score-cell">${safeText(data.basic_edu_score)}</td>
      <td class="border">${formatMultiline(data.basic_edu_comment)}</td>
    </tr>
    <tr>
      <td class="border">工作經歷</td>
      <td class="border score-cell">${safeText(data.basic_exp_score)}</td>
      <td class="border">${formatMultiline(data.basic_exp_comment)}</td>
    </tr>
  </table>

  <div class="section-title">二、專業能力（每項滿分 10 分）</div>
  <table>
    <tr>
      <th class="border">項目</th>
      <th class="border">評分</th>
      <th class="border">評語</th>
    </tr>
    <tr>
      <td class="border">技術技能</td>
      <td class="border score-cell">${safeText(data.pro_tech_score)}</td>
      <td class="border">${formatMultiline(data.pro_tech_comment)}</td>
    </tr>
    <tr>
      <td class="border">問題解決能力</td>
      <td class="border score-cell">${safeText(data.pro_problem_score)}</td>
      <td class="border">${formatMultiline(data.pro_problem_comment)}</td>
    </tr>
    <tr>
      <td class="border">學習能力</td>
      <td class="border score-cell">${safeText(data.pro_learning_score)}</td>
      <td class="border">${formatMultiline(data.pro_learning_comment)}</td>
    </tr>
  </table>

  <div class="section-title">三、軟技能（每項滿分 10 分）</div>
  <table>
    <tr>
      <th class="border">項目</th>
      <th class="border">評分</th>
      <th class="border">評語</th>
    </tr>
    <tr>
      <td class="border">溝通能力</td>
      <td class="border score-cell">${safeText(data.soft_comm_score)}</td>
      <td class="border">${formatMultiline(data.soft_comm_comment)}</td>
    </tr>
    <tr>
      <td class="border">團隊合作</td>
      <td class="border score-cell">${safeText(data.soft_team_score)}</td>
      <td class="border">${formatMultiline(data.soft_team_comment)}</td>
    </tr>
    <tr>
      <td class="border">時間管理</td>
      <td class="border score-cell">${safeText(data.soft_time_score)}</td>
      <td class="border">${formatMultiline(data.soft_time_comment)}</td>
    </tr>
    <tr>
      <td class="border">抗壓能力</td>
      <td class="border score-cell">${safeText(data.soft_stress_score)}</td>
      <td class="border">${formatMultiline(data.soft_stress_comment)}</td>
    </tr>
  </table>

  <div class="section-title">四、面試表現（每項滿分 5 分）</div>
  <table>
    <tr>
      <th class="border">項目</th>
      <th class="border">評分</th>
      <th class="border">評語</th>
    </tr>
    <tr>
      <td class="border">應對能力</td>
      <td class="border score-cell">${safeText(data.perf_response_score)}</td>
      <td class="border">${formatMultiline(data.perf_response_comment)}</td>
    </tr>
    <tr>
      <td class="border">職業態度</td>
      <td class="border score-cell">${safeText(data.perf_attitude_score)}</td>
      <td class="border">${formatMultiline(data.perf_attitude_comment)}</td>
    </tr>
    <tr>
      <td class="border">儀表儀態</td>
      <td class="border score-cell">${safeText(data.perf_manner_score)}</td>
      <td class="border">${formatMultiline(data.perf_manner_comment)}</td>
    </tr>
  </table>

  <div class="box-line"></div>

  <p><strong>總分（滿分 100 分）：</strong> ${safeText(data.totalScore)}</p>

  <p><strong>總評 — 綜合評價及建議：</strong></p>
  <p>${formatMultiline(data.overall_comment)}</p>

  <div class="section-title">候選人自述與補充資訊</div>
  <p><strong>最有成就感的事情與經驗：</strong><br>${formatMultiline(data.achievement_note)}</p>
  <p><strong>遇到的最大挫折與解法：</strong><br>${formatMultiline(data.challenge_note)}</p>
  <p><strong>自述的優點 #1：</strong><br>${formatMultiline(data.strength_primary)}</p>
  <p><strong>自述的優點 #2：</strong><br>${formatMultiline(data.strength_secondary)}</p>
  <p><strong>自述的缺點 #1：</strong><br>${formatMultiline(data.weakness_primary)}</p>
  <p><strong>自述的缺點 #2：</strong><br>${formatMultiline(data.weakness_secondary)}</p>
  <p><strong>AI 使用情況：</strong> ${safeText(aiToolsText)}</p>
  <p><strong>ERP 使用經驗：</strong> ${safeText(erpStatusText)}</p>
  <p><strong>使用過的 ERP 系統：</strong> ${safeText(erpSystemsText)}</p>
  <p><strong>DISC 類型：</strong> ${safeText(data.disc_type || "未填寫")}</p>

  <div class="section-title">寵物與照護資訊</div>
  <p><strong>是否有養寵物：</strong> ${safeText(petStatusText)}</p>
  <p><strong>寵物類型：</strong> ${safeText(petTypesText)}</p>
  <p><strong>是否為飼料挑選者：</strong> ${safeText(petFeederText)}</p>
  <p><strong>寵物備註：</strong><br>${formatMultiline(data.pet_note)}</p>

  <div class="section-title">面試者提問</div>
  ${questionListHtml}

  <div class="box-line"></div>

  <p class="signature-line">
    面試官簽名： __________________________
    &nbsp;&nbsp;&nbsp;&nbsp;
    （姓名：${safeText(data.signature)}）
  </p>

</body>
</html>
      `;

      const blob = new Blob(["\ufeff", htmlContent], {
        type: "application/msword;charset=utf-8"
      });

      let filename = "面試評分表";
      if (data.candidateName) {
        filename += "-" + data.candidateName;
      }
      filename += ".doc";

      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");
      link.href = url;
      link.download = filename;
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      URL.revokeObjectURL(url);
    }

    updateTotalScore();
    updateAiToolsVisibility();
    updateErpVisibility();
    updateDiscInfo();
    updatePetVisibility();
  </script>
</body>
</html>
